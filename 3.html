<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport"/>
    <title>الروايات - روايات تناقض بعضها</title>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4459876088599546" crossorigin="anonymous"></script>
    
    <!-- Favicon -->
    <link href="images/logo-small.png" rel="icon" type="image/png"/>
    <link href="images/logo-small.png" rel="apple-touch-icon"/>

    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --primary-color: #5e2ca5;
            --primary-dark: #451b7a; 
            --primary-light: #8a5bc7;
            --accent-color: #ffd700;
            --bg-color: #f9f7f2;
            --surface-color: #F8F5FD; 
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --shadow-sm: 0 4px 15px rgba(94, 44, 165, 0.08);
            --shadow-md: 0 8px 20px rgba(94, 44, 165, 0.12);
            --shadow-lg: 0 15px 30px rgba(0,0,0,0.1);
            --radius-lg: 1rem;
            --radius-xl: 1.5rem;
            --number-border: #8E13BB; 
            --matte-purple: #7c5295; 
            --reading-beige: #FCF9F1; 
            --btt-bg: #8E13BB;
            --btt-accent: #FFC600;
            
            /* متغير التحكم بحجم الخط للمحتوى */
            --dynamic-content-size: 1.15rem;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Tajawal', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            width: 100%;
        }

        body.no-scroll {
            overflow: hidden !important;
            height: 100vh;
            position: fixed;
            width: 100%;
        }

        a { text-decoration: none; color: inherit; transition: all 0.3s ease; }

        /* ==================== Navigation ==================== */
        .nav-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.6); backdrop-filter: blur(4px);
            z-index: 998; display: none;
        }

        nav {
            background: rgba(94, 44, 165, 0.98);
            backdrop-filter: blur(10px);
            padding: 0 5%;
            position: fixed;
            width: 100%; top: 0; z-index: 1000;
            display: flex; align-items: center; justify-content: space-between;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            height: 75px;
        }

        .logo-container { order: 1; }
        .logo-container img { height: 45px; width: auto; transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275), filter 0.4s ease; }

        .nav-links {
            display: flex; flex: 1; justify-content: space-evenly; align-items: center; margin: 0 10px; order: 2;
        }

        .nav-links a {
            color: white; font-weight: 700; font-size: 0.95rem; padding: 8px 12px; border-radius: 20px; white-space: nowrap;
            display: flex; align-items: center; gap: 5px;
        }

        .nav-links a:hover, .nav-links a.active { background: rgba(255,255,255,0.15); transform: translateY(-2px); }

        .hamburger { display: none; color: white; font-size: 1.5rem; cursor: pointer; order: 3; }

        @media (max-width: 1200px) {
            .hamburger { display: block; order: 1; }
            .logo-container { order: 2; }
            .nav-links {
                position: fixed; top: 75px; right: -280px; width: 280px;
                background: var(--surface-color);
                flex-direction: column; padding: 20px; height: calc(100vh - 75px);
                box-shadow: -5px 0 15px rgba(0,0,0,0.1); transition: right 0.3s ease;
                overflow-y: auto; flex-wrap: nowrap; justify-content: flex-start;
                gap: 10px; margin: 0; flex: unset; z-index: 1000; display: flex !important;
            }
            .nav-links.show { right: 0; }
            .nav-links a { 
                color: var(--text-primary); width: 100%; padding: 12px; 
                border-radius: 8px; font-size: 1rem; justify-content: flex-start; 
                border-bottom: 1px solid rgba(0,0,0,0.03);
            }
            .nav-links a:hover { background: rgba(94, 44, 165, 0.05); color: var(--primary-color); transform: none; }
        }

        /* ==================== Header & Search ==================== */
        .unified-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
            padding: 100px 0 40px; border-radius: 0 0 50px 50px; margin-bottom: 30px;
            width: 100%; text-align: center; color: white; position: relative; z-index: 1;
        }
        .page-title { font-size: 2.2rem; font-weight: 800; margin-bottom: 10px; }
        .page-subtitle { color: #e2e8f0; font-size: 1.1rem; max-width: 800px; margin: 0 auto; padding: 0 20px; }

        .universal-search { width: 100%; max-width: 600px; margin: 35px auto 0; position: relative; z-index: 1002; }
        #globalSearch { 
            width: 100%; padding: 18px 25px; border-radius: 50px; border: none; font-size: 1rem; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.2); outline: none; text-align: right;
            font-family: 'Tajawal', sans-serif;
        }
        .search-results {
            position: absolute; top: 110%; left: 0; right: 0; 
            background: white; border-radius: 15px; max-height: 400px; 
            overflow-y: auto; display: none; z-index: 1002; color: #333; 
            text-align: right; box-shadow: var(--shadow-lg); border: 1px solid rgba(0,0,0,0.05);
        }
        .search-item { padding: 15px 20px; border-bottom: 1px solid rgba(0,0,0,0.05); cursor: pointer; transition: background 0.2s; }
        .search-item:hover { background: rgba(94, 44, 165, 0.05); }
        mark { background-color: #ffd700; color: #000; padding: 0 2px; border-radius: 2px; }

        /* ==================== Hadith Card Styling ==================== */
        .container { max-width: 1150px; margin: 0 auto; padding: 0 20px 60px; width: 100%; }
        .hadith-row { display: flex; align-items: flex-start; gap: 20px; margin-bottom: 30px; width: 100%; transition: all 0.3s ease; }
        
        .hadith-number-circle { 
            width: 46px; height: 46px; background-color: #FFC600; border: 2.5px solid #8E13BB; 
            color: #8E13BB; border-radius: 50%; display: flex; align-items: center; justify-content: center; 
            font-weight: 800; font-size: 1.3rem; flex-shrink: 0; box-shadow: 0 4px 8px rgba(0,0,0,0.1); 
            margin-top: 15px; padding-top: 4px; z-index: 5;
        }
        
        .hadith-card { 
            background: var(--surface-color); border-radius: var(--radius-xl); 
            box-shadow: var(--shadow-sm); border-right: 6px solid var(--primary-color); 
            overflow: hidden; transition: 0.3s; flex: 1; border: 1px solid rgba(0,0,0,0.05);
            position: relative; 
        }
        
        .hadith-summary { padding: 25px 25px 25px 45px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; gap: 15px; }
        .hadith-summary h3 { font-size: 1.3rem; color: var(--primary-dark); font-weight: 800; flex: 1; text-align: right; transition: all 0.3s ease; }
        .hadith-summary:hover h3 { color: #7c3aed; transform: translateX(-5px); }
        .source-tag { background: #FFC600; padding: 5px 12px; border-radius: 8px; font-size: 0.85rem; font-weight: 800; color: var(--primary-color); }
        
        .fav-header-icon { 
            font-size: 1.6rem; color: var(--matte-purple); transition: all 0.3s ease; cursor: pointer; 
            position: absolute; top: 0; left: 0; padding: 10px 15px; z-index: 10;
        }
        .fav-header-icon:hover { transform: scale(1.15); color: var(--primary-color); }
        .fav-header-icon.active { color: var(--primary-color); }

        .hadith-details { 
            max-height: 0; opacity: 0; overflow: hidden; 
            transition: max-height 0.7s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.5s ease-in-out; 
            background: var(--reading-beige); 
        }
        .hadith-details.open { max-height: 5000px; opacity: 1; padding: 10px 30px 50px; border-top: 1px solid rgba(0,0,0,0.05); }

        .detail-section { margin-top: 25px; background: transparent; border: none; }
        .section-header { 
            padding-bottom: 8px; margin-bottom: 10px; font-weight: 800; font-size: 1.1rem; 
            display: flex; align-items: center; gap: 10px; color: var(--primary-dark);
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }
        .section-content { padding: 5px 0 10px; line-height: 1.8; font-size: var(--dynamic-content-size); color: #334155; }

        .hadith-actions { display: flex; align-items: center; gap: 15px; margin-top: 25px; padding-top: 20px; border-top: 1px dashed rgba(0,0,0,0.08); }
        .action-btn { font-size: 0.9rem; font-weight: 700; padding: 10px 18px; border-radius: 8px; display: flex; align-items: center; gap: 8px; transition: 0.3s; cursor: pointer; text-decoration: none !important; }
        .btn-source { background: rgba(94, 44, 165, 0.1); color: var(--primary-color); border: 1px solid rgba(94, 44, 165, 0.2); }
        .btn-source:hover { background: var(--primary-color); color: white; }
        .btn-report { background: rgba(225, 29, 72, 0.08); color: #e11d48; border: 1px solid rgba(225, 29, 72, 0.1); }
        .btn-report:hover { background: #e11d48; color: white; }

        /* ==================== Font Controls & Back to top ==================== */
        .font-controls-fixed { position: fixed; top: 120px; left: 30px; display: flex; flex-direction: column; gap: 10px; z-index: 990; }
        .font-btn { width: 45px; height: 45px; border-radius: 50%; background: white; border: 1px solid #e2e8f0; color: var(--primary-color); cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 1.1rem; box-shadow: var(--shadow-sm); transition: 0.3s; }
        .font-btn:hover { background: var(--primary-color); color: white; transform: scale(1.1); }

        .back-to-top {
            position: fixed; bottom: 30px; right: 30px; width: 50px; height: 50px;
            background-color: var(--btt-bg); border: 3px solid var(--btt-accent);
            color: var(--btt-accent); border-radius: 50%; display: flex;
            align-items: center; justify-content: center; font-size: 1.2rem;
            cursor: pointer; z-index: 1001; transition: all 0.4s ease;
            opacity: 0; visibility: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .back-to-top.show { opacity: 1; visibility: visible; }
        .back-to-top:hover { transform: translateY(-5px) scale(1.05); background-color: var(--primary-dark); }

        /* ==================== Pagination ==================== */
        #pagination-wrapper { background: var(--surface-color); padding: 25px; border-radius: var(--radius-lg); box-shadow: var(--shadow-sm); text-align: center; margin: 40px auto; border: 1px solid rgba(0,0,0,0.05); max-width: 500px; }
        .pagination-btn { background: #f1f5f9; color: var(--text-primary); border: none; padding: 10px 20px; border-radius: 12px; cursor: pointer; margin: 0 5px; font-family: 'Tajawal'; font-weight: 600; transition: 0.3s; }
        .pagination-btn:hover { background: var(--primary-color); color: white; transform: translateY(-2px); }
        .pagination-btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; background: #e2e8f0; color: #94a3b8; }
        .pagination-info-container { display: flex; justify-content: center; align-items: center; gap: 20px; flex-wrap: wrap; margin-bottom: 15px; font-weight: 700; color: var(--text-primary); }
        .total-count-badge { background: var(--primary-color); color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.9rem; }

        /* ==================== Social Media ==================== */
        .social-section { text-align: center; margin-bottom: 60px; background: var(--surface-color); padding: 40px; border-radius: var(--radius-xl); box-shadow: var(--shadow-sm); margin-top: 50px; }
        .social-grid { display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; margin-top: 30px; }
        .social-btn { width: 55px; height: 55px; border-radius: 50%; display: flex; align-items: center; justify-content: center; background: white; transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .social-btn img { width: 26px; transition: 0.3s; }
        .social-btn:hover { transform: translateY(-8px) scale(1.1); box-shadow: 0 10px 20px rgba(0,0,0,0.15); }
        .social-btn:hover img { filter: brightness(0) invert(1); }
        .social-yt:hover { background: #FF0000; } 
        .social-fb:hover { background: #1877F2; } 
        .social-ins:hover { background: #E4405F; } 
        .social-tg:hover { background: #0088CC; } 
        .social-tk:hover { background: #000000; } 
        .social-sc:hover { background: #FFFC00; }

        /* ==================== Footer ==================== */
        footer { background: #1e293b; color: white; padding: 60px 20px; text-align: center; width: 100%; margin-top: 50px; }
        .footer-links { display: flex; justify-content: center; gap: 12px; margin-bottom: 25px; flex-wrap: wrap; align-items: center; }
        .footer-links a { color: #cbd5e1; font-weight: 500; font-size: 0.95rem; text-decoration: none; transition: color 0.3s ease; }
        .footer-links a:hover { color: var(--accent-color); }
        .footer-divider { color: #475569; font-size: 0.8rem; user-select: none; } 
        .copyright { color: #64748b; font-size: 0.85rem; border-top: 1px solid #334155; padding-top: 25px; margin-top: 25px; }

        /* ==================== Mobile Design ==================== */
        @media (max-width: 768px) {
            .hadith-summary h3 { font-size: 1.05rem !important; }
            .unified-header { padding: 90px 15px 40px; border-radius: 0 0 35px 35px; }
            .page-title { font-size: 1.7rem; }
            .hadith-row { flex-direction: row; align-items: flex-start; gap: 10px; }
            .hadith-row.is-open { flex-direction: column; }
            .hadith-row.is-open .hadith-number-circle { margin-top: 0; margin-bottom: 5px; align-self: flex-start; }
            .hadith-number-circle { width: 38px; height: 38px; font-size: 1rem; margin-top: 25px; }
            .hadith-card { width: 100%; }
            .hadith-details.open { padding: 15px 15px 40px; }
            .font-controls-fixed { left: 15px; top: auto; bottom: 20px; flex-direction: row; }
            .back-to-top { bottom: 80px; right: 20px; width: 45px; height: 45px; }
        }

        /* ==================== Report Modal & Toast ==================== */
        .report-modal { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); backdrop-filter: blur(5px); display: none; align-items: center; justify-content: center; z-index: 2000; padding: 20px; }
        .report-modal.show { display: flex; }
        .modal-box { background: white; width: 100%; max-width: 420px; border-radius: 20px; padding: 30px; box-shadow: var(--shadow-lg); animation: slideIn 0.3s ease; }
        @keyframes slideIn { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .report-option { display: flex; align-items: center; gap: 12px; padding: 14px 18px; border: 1px solid #e2e8f0; border-radius: 12px; margin-bottom: 12px; cursor: pointer; }
        .btn-send { flex: 2; background: var(--primary-color); color: white; border: none; padding: 14px; border-radius: 12px; font-family: 'Tajawal'; font-weight: 700; cursor: pointer; }
        .btn-cancel { flex: 1; background: #f1f5f9; color: #475569; border: none; padding: 14px; border-radius: 12px; font-family: 'Tajawal'; cursor: pointer; }
        .success-toast { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%) translateY(100px); background: #059669; color: white; padding: 14px 35px; border-radius: 50px; font-weight: 700; box-shadow: 0 10px 25px rgba(0,0,0,0.2); z-index: 3000; transition: 0.5s; opacity: 0; display: flex; align-items: center; gap: 12px; }
        .success-toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }
    </style>
</head>
<body>

<div class="nav-overlay" id="navOverlay" onclick="toggleMobileMenu()"></div>

<nav>
    <div class="logo-container"><a href="/index.html"><img src="/images/logo.png" alt="logo" /></a></div>
    <div class="nav-links" id="navLinks">
        <a href="/index.html">الرئيسية</a>
        <a href="/books.html">الكتب</a>
        <a href="/articles.html">المقالات</a>
        <a href="/hadith.html" class="active">الروايات</a>
        <a href="/khawatir.html">خواطر</a>
        <a href="/videos.html">الفيديوهات</a>
        <a href="/history.html">التاريخ</a>
        <a href="/podcast.html">البودكاست</a>
        <a href="/ask.html">الأسئلة</a>
        <a href="/hewar.html">حوارات</a>
        <a href="/inq.html">تساؤلات</a>
        <a href="/manhaj.html">المنهج</a>
        <a href="/favorites.html">المفضلة</a>
        <a href="/support.html">دعم المحتوى</a>
        <a href="/about.html">من نحن</a>
    </div>
    <div class="hamburger" onclick="toggleMobileMenu()"><i class="fas fa-bars"></i></div>
</nav>

<div class="font-controls-fixed">
    <button class="font-btn" id="fontIncrease" title="تكبير"><i class="fas fa-plus"></i></button>
    <button class="font-btn" id="fontReset" title="إعادة"><i class="fas fa-redo"></i></button>
    <button class="font-btn" id="fontDecrease" title="تصغير"><i class="fas fa-minus"></i></button>
</div>

<button class="back-to-top" id="backToTop" title="العودة للأعلى"><i class="fas fa-chevron-up"></i></button>

<header class="unified-header">
    <h1 class="page-title">روايات تناقض بعضها</h1>
    <p class="page-subtitle">رصد للتناقضات الصارخة والاضطراب داخل منظومة الروايات</p>
    <div class="universal-search">
        <input type="text" id="globalSearch" placeholder="ابحث في جميع المحتويات..." />
        <div class="search-results" id="searchResults"></div>
    </div>
</header>

<div class="container">
    <div id="hadithContainer"></div>

    <div id="pagination-wrapper">
        <div class="pagination-info-container">
            <span id="pageInfo">الصفحة 1 من 1</span>
            <span class="total-count-badge" id="totalHadithCount">عدد الروايات: 0</span>
        </div>
        <div style="margin-top: 15px;">
            <button id="firstPage" class="pagination-btn">الأولى</button>
            <button id="prevPage" class="pagination-btn">السابق</button>
            <button id="nextPage" class="pagination-btn">التالي</button>
        </div>
    </div>

    <!-- قسم تابعنا -->
    <div class="social-section">
        <h2 style="font-weight: 800; color: var(--primary-dark); margin-bottom: 10px;">تابعنا على منصات التواصل</h2>
        <div class="social-grid">
            <a href="https://youtube.com/@husseinalkhalil" target="_blank" class="social-btn social-yt" title="يوتيوب"><img src="/icons/yot-soc.png" alt="yt"></a>
            <a href="https://www.facebook.com/hussien.alkhalil" target="_blank" class="social-btn social-fb" title="فيسبوك"><img src="/icons/fac-soc.png" alt="fb"></a>
            <a href="https://instagram.com/husseinalkhalil" target="_blank" class="social-btn social-ins" title="إنستغرام"><img src="/icons/ins-soc.png" alt="in"></a>
            <a href="https://t.me/tanoeer" target="_blank" class="social-btn social-tg" title="تلغرام"><img src="/icons/tel-soc.png" alt="tg"></a>
            <a href="https://tiktok.com/@h.alkhalil" target="_blank" class="social-btn social-tk" title="تيك توك"><img src="/icons/tik-soc.png" alt="tk"></a>
            <a href="https://snapchat.com/t/sFLWjw3K" target="_blank" class="social-btn social-sc" title="سناب شات"><img src="/icons/snap.png" alt="sc"></a>
        </div>
    </div>
</div>

<div class="report-modal" id="reportModal">
    <div class="modal-box">
        <h2>إبلاغ عن محتوى</h2>
        <p id="modalHadithInfo">أنت تبلغ عن: جاري التحديد...</p>
        <form name="hadith-reports" id="reportForm" method="POST" data-netlify="true">
            <input type="hidden" name="hadith_name" id="hiddenHadithName">
            <input type="hidden" name="hadith_number" id="hiddenHadithNumber">
            <label class="report-option"><input type="radio" name="issue_type" value="الرابط لا يعمل" required> <span>الرابط لا يعمل</span></label>
            <label class="report-option"><input type="radio" name="issue_type" value="الحديث غير مطابق"> <span>الحديث غير مطابق</span></label>
            <label class="report-option"><input type="radio" name="issue_type" value="رقم الحديث غير مطابق"> <span>رقم الحديث غير مطابق</span></label>
            <div class="modal-footer" style="display:flex; gap:10px; margin-top:20px;">
                <button type="submit" class="btn-send">إرسال البلاغ</button>
                <button type="button" class="btn-cancel" onclick="closeReportModal()">إلغاء</button>
            </div>
        </form>
    </div>
</div>

<div class="success-toast" id="successToast"><i class="fas fa-check-circle"></i> <span>شكراً لمساهمتك</span></div>

<footer>
    <div class="footer-links">
        <a href="/terms.html">الشروط والأحكام</a> <span class="footer-divider">|</span>
        <a href="/privacy.html">سياسة الخصوصية</a> <span class="footer-divider">|</span>
        <a href="/contact.html">اتصل بنا</a> <span class="footer-divider">|</span>
        <a href="/feedback.html">شاركنا رأيك</a>
    </div>
    <div class="copyright">حسين الخليل - جميع الحقوق محفوظة © 2025</div>
</footer>

<script>
    // ==================== البيانات والبرمجة ====================
    const novelsData = [
        {
            id: 1, 
            title: "تدوين الرواية", 
            source: "مسلم/أبي داوود", 
            sourceUrl: "https://dorar.net/h/Ai8gLnrl",
            text: `لا تَكْتُبُوا عَنِّي، ومَن كَتَبَ عَنِّي غيرَ القُرْآنِ فَلْيَمْحُهُ، وحَدِّثُوا عَنِّي، ولا حَرَجَ، ومَن كَذَبَ عَلَيَّ -قالَ هَمَّامٌ: أحْسِبُهُ قالَ: مُتَعَمِّدًا- فَلْيَتَبَوَّأْ مَقْعَدَهُ مِنَ النَّارِ.`, 
            num: "3004",
            secondHadithText: `عن عبدِ اللهِ بنِ عمرٍو رَضِيَ اللهُ عنهما، قال: كنتُ أكتُبُ كلَّ شيءٍ أسمَعُهُ مِن رسولِ اللهِ صلَّى اللهُ عليه وسلَّمَ، أُريدُ حِفْظَهُ، فنهَتْني قريشٌ، وقالوا: أتكتُبُ كلَّ شيءٍ تسمَعُهُ ورسولُ اللهِ صلَّى اللهُ عليه وسلَّمَ بشَرٌ يتكلَّمُ في الغضبِ والرِّضا؟! فأمسَكْتُ عَنِ الكِتابِ، فذكَرْتُ ذلك لرسولِ اللهِ صلَّى اللهُ عليه وسلَّمَ، فأَوْمأَ بإِصْبَعِهِ إلى فِيهِ، فقال: اكتُبْ؛ فوالذي نفْسي بيدِهِ، ما يخرُجُ منه إلَّا حقٌّ.`,
            secondHadithNum: "3646",
            secondHadithUrl: "https://dorar.net/h/IltCGHdt",
            reason: `يوجد تصادم جبهوي بين روايتين الأولى تأمر بمحو كل ما كُتب غير القرآن وتنهى عن التدوين نهياً مطلقاً، والثانية تأذن وتأمر بالتدوين وتؤكد أن كل ما يصدر عن النبي هو "حق" يستحق الكتابة. هذا الاضطراب جعل الأمة تائهة لقرون بين التدوين والترك، ويثبت أن "السنة" لم تكن وحياً محفوظاً ومكتوباً بقرار نبوي كالقرآن، بل كانت خاضعة لاجتهادات الرواة وتناقض مروياتهم.`
        },
        {
            id: 2, 
            title: "القيام للجنازة", 
            source: "البخاري/مسلم", 
            sourceUrl: "https://dorar.net/h/EsWsd04S",
            text: `إِذَا رَأَيْتُمُ الجَنَازَةَ، فَقُومُوا، فمَن تَبِعَهَا فلا يَقْعُدْ حتَّى تُوضَعَ.`, 
            num: "1310",
            secondHadithText: `رَأَيْنَا رَسولَ اللهِ صَلَّى اللَّهُ عليه وَسَلَّمَ قَامَ فَقُمْنَا وَقَعَدَ فَقَعَدْنَا يَعْنِي في الجَنَازَةِ.`,
            secondHadithNum: "962",
            secondHadithUrl: "https://dorar.net/h/LsJS0fon",
            reason: `الرواية الأولى تضع أمراً (فقموا) بصيغة الوجوب أو الاستحباب المؤكد لكل من يرى جنازة، بينما الرواية الثانية تخبر أن النبي "جلس" وترك القيام، مما جعل الفقهاء يتخبطون بين قائل إن الأمر منسوخ وقائل إنه مخير. هذا التناقض في حركات النبي البسيطة (القيام والجلوس) يوضح كيف أن الروايات تنقل تفاصيل يومية متضاربة لا يمكن بناء تشريع يقيني عليها.`
        },
        {
            id: 3, 
            title: "مس الذكر والوضوء", 
            source: "الترمذي/النسائي", 
            sourceUrl: "https://dorar.net/h/vfLRP1Vh",
            text: `مَن مسَّ ذَكرَه فلا يصلِّ حتَّى يتَوضَّأ`, 
            num: "82",
            secondHadithText: `خرجنا وفدًا حتَّى قدمنا علَى رسولِ اللَّهِ صلَّى اللَّهُ عليهِ وسلَّمَ فبايعناهُ وصلَّينا معَه فلمَّا قضى الصَّلاةَ جاءَ رجلٌ كأنَّهُ بدويٌّ فقالَ يا رسولَ اللَّهِ ما ترى في رجلٍ مسَّ ذَكرَه في الصَّلاةِ قالَ وَهل هوَ إلَّا مضغةٌ منكَ أو بضعةٌ منكَ`,
            secondHadithNum: "165",
            secondHadithUrl: "https://dorar.net/h/6aMH7tfL",
            reason: `هنا تناقض كامل في حكم "طهارة" يمارسها المسلم يومياً. الرواية الأولى تجزم بنقض الوضوء وتأمر بإعادته، بينما الرواية الثانية تنفي النقض تماماً وبعلة منطقية (أنه جزء من الجسد كاليد). هذا التضارب جعل المسلمين منقسمين في صلاتهم وطهارتهم لألف عام، وهو دليل على أن هذه المرويات لم تكن ديناً عاماً معلوماً، بل أخبار آحاد متضاربة.`
        },
        {
            id: 4, 
            title: "الأكل قائماً", 
            source: "مسلم/ ابن ماجه", 
            sourceUrl: "https://dorar.net/h/i0wPkEWe",
            text: `عَنِ النَّبيِّ صَلَّى اللَّهُ عليه وَسَلَّمَ: أنَّهُ نَهَى أَنْ يَشْرَبَ الرَّجُلُ قَائِمًا. قالَ قَتَادَةُ: فَقُلْنَا: فَالأكْلُ، فَقالَ: ذَاكَ أَشَرُّ، أَوْ أَخْبَثُ.`, 
            num: "2024",
            secondHadithText: `كنَّا على عَهدِ رسولِ اللَّهِ صلَّى اللَّهُ عليهِ وسلَّمَ نأكُلُ ونحنُ نمشي ونشرَبُ ونحنُ قيامٌ`,
            secondHadithNum: "2686",
            secondHadithUrl: "https://dorar.net/h/hGJRrRRE",
            reason: `الرواية الأولى تغلظ في النهي عن الشرب والأكل قائماً وتصفه بـ "الأشر والأخبث"، بينما الرواية الثانية تؤكد أن الصحابة كانوا يفعلون ذلك "على عهد النبي" (أي بعلمه وإقراره) وهم يمشون ويقفون. كيف ينهى النبي عن فعل ويصفه بالخبث، ثم يمارسه أصحابه المقربون أمامه دون نكير؟`
        },
        {
            id: 5, 
            title: "نكاح المرأة بغير ولي", 
            source: "أبي داوود/مسلم", 
            sourceUrl: "https://dorar.net/h/2m0mJdTa",
            text: `أيُّما امرأةٍ نَكَحَت بغيرِ إذنِ مَواليها ، فنِكاحُها باطلٌ.`, 
            num: "2083",
            secondHadithText: `الثَّيِّبُ أَحَقُّ بنَفْسِهَا مِن وَلِيِّهَا، وَالْبِكْرُ تُسْتَأْمَرُ، وإذْنُهَا سُكُوتُهَا.`,
            secondHadithNum: "1421",
            secondHadithUrl: "https://dorar.net/h/6lMjLadP",
            reason: `الرواية الأولى تضع قاعدة صارمة تبطل زواج المرأة تماماً إذا تم من دون ولي (الأب أو الأخ)، وتصفه بالبطلان ثلاثاً. بينما الرواية الثانية تمنح المرأة (الثيب) السيادة الكاملة على قرارها وتجعلها "أحق بنفسها" من وليها، مما يعني أن دور الولي شكلي أو استشاري فقط. هذا التضارب أدى لشرخ فقهي كبير بين المذاهب (كالأحناف والشافعية)، فمنهم من حرّم ومنهم من أحلّ بناءً على روايات متصادمة.`
        },
        {
            id: 6, 
            title: "العدوى بين الإثبات والنفي", 
            source: "البخاري/البخاري", 
            sourceUrl: "https://dorar.net/h/KfeeOSRU",
            text: `لا عَدْوَى ولا طِيَرَةَ، ولا هامَةَ ولا صَفَرَ.`, 
            num: "5757",
            secondHadithText: `لا يُورِدَنَّ مُمْرِضٌ علَى مُصِحٍّ وأَنْكَرَ أبو هُرَيْرَةَ حَدِيثَ الأوَّلِ، قُلْنا: ألَمْ تُحَدِّثْ أنَّهُ: لا عَدْوَى فَرَطَنَ بالحَبَشِيَّةِ، قالَ أبو سَلَمَةَ: فَما رَأَيْتُهُ نَسِيَ حَدِيثًا غَيْرَهُ.`,
            secondHadithNum: "5771",
            secondHadithUrl: "https://dorar.net/h/uNsywJz3",
            reason: `الرواية الأولى تنفي "العدوى" تماماً بأسلوب القصر (لا عدوى)، وهو ما يصدم الحقائق الطبية. أما الرواية الثانية (والتي يرويها نفس الراوي: أبو هريرة وفي نفس الكتاب: البخاري) فهي تأمر بعكس ذلك تماماً؛ حيث تنهى عن خلط المريض بالصحيح وتأمر بالفرار من المجذوم خشية العدوى. عندما واجه الصحابة أبا هريرة بهذا التناقض، تقول الرواية إنه "غضب وسكت ونسي الرواية الأولى"!`
        },
        {
            id: 7, 
            title: "زيارة القبور", 
            source: "الترمذي/مسلم", 
            sourceUrl: "https://dorar.net/h/xx1OeLZ0",
            text: `أنَّ رَسولَ اللَّهِ صلَّى اللَّهُ عليهِ وسلَّمَ لَعنَ زوَّاراتِ القبورِ.`, 
            num: "1056",
            secondHadithText: `نَهَيْتُكُمْ عن زِيارَةِ القُبُورِ، فَزُورُوها،`,
            secondHadithNum: "1977",
            secondHadithUrl: "https://dorar.net/h/uFKEkfU3",
            reason: `يوجد تضارب حاد بين "اللعن" (وهو الطرد من رحمة الله) وبين "الأمر" بالزيارة. الرواية الأولى تجعل من زيارة النساء للقبور جريمة تستحق اللعنة، بينما الرواية الثانية تعلن نسخ النهي القديم وتأمر الجميع بالزيارة لأنها "تذكر بالآخرة". هذا التناقض جعل المجتمع المسلم في حيرة وتشدد تجاه النساء، فمنهم من يمنعهن ومنهم من يبيح لهن، بناءً على نصوص متصارعة.`
        },
        {
            id: 8, 
            title: "الجهر بـ \"البسملة\" في الصلاة", 
            source: "مسلم/الدارقطني", 
            sourceUrl: "https://dorar.net/h/IWfk16ch",
            text: `صَلَّيْتُ مع رَسولِ اللهِ صَلَّى اللَّهُ عليه وسلَّمَ وأَبِي بَكْرٍ، وعُمَرَ، وعُثْمَانَ، فَلَمْ أسْمَعْ أحَدًا منهمْ يَقْرَأُ {بِسْمِ اللهِ الرَّحْمَنِ الرَّحِيمِ}.`, 
            num: "399",
            secondHadithText: `عن نُعَيمٍ المُجمِرِ قال: صلَّيتُ خَلفَ أبي هُرَيرةَ فقال -وفي لفظٍ: فقَرأ-: {بِسْمِ اللَّهِ الرَّحْمَنِ الرَّحِيمِ} ثم قرَأ بأُمِّ القُرآنِ، فلَمَّا سلَّمَ قال: والذي نَفْسي بيَدِه إنِّي لَأشبَهُكم صَلاةً برَسولِ اللهِ صلَّى اللهُ عليه وسلَّمَ.`,
            secondHadithNum: "2/177",
            secondHadithUrl: "https://dorar.net/h/Lj0Npxye",
            reason: `هذا تناقض في شعيرة تُؤدى يومياً أمام آلاف الصحابة. رواية أنس تجزم بأن النبي لم يكن يجهر ولا يذكر البسملة أصلاً في الصلاة الجهرية، ورواية أبي هريرة تجزم بأن النبي كان يجهر بها وأنه هو وحده الذي يقلد صلاة النبي بدقة. هذا الخلاف هو سبب تشتت المذاهب اليوم بين من يسرّ ومن يجهر ومن يبطل الصلاة من دونها.`
        },
        {
            id: 9, 
            title: "التناقض في وصف الدجال", 
            source: "البخاري/مسلم", 
            sourceUrl: "https://dorar.net/h/pM7tZJLW",
            text: `وإنَّ المَسِيحَ الدَّجَّالَ أعْوَرُ العَيْنِ اليُمْنَى، كَأنَّ عَيْنَهُ عِنَبَةٌ طَافِيَةٌ.`, 
            num: "7407",
            secondHadithText: `الدَّجَّالُ أعْوَرُ العَيْنِ اليُسْرَى، جُفالُ الشَّعَرِ، معهُ جَنَّةٌ ونارٌ، فَنارُهُ جَنَّةٌ وجَنَّتُهُ نارٌ.`,
            secondHadithNum: "2934",
            secondHadithUrl: "https://dorar.net/h/9nlQnQuf",
            reason: `يوجد تصادم صريح ومباشر في تحديد "العين العوراء" للدجال؛ فبينما يجزم البخاري بأن العور في "العين اليمنى"، يجزم تلميذه مسلم بأن العور في "العين اليسرى". هذا التناقض في علامة جسدية جوهرية يُفترض أنها وسيلة المؤمنين للتعرف على الدجال وتحذير الناس منه، يثبت اضطراب الرواة في نقل التفاصيل الغيبية، ويجعل من المستحيل الجزم بأي الوصفين هو الصحيح، مما يُفقد الرواية قيمتها التحذيرية.`
        },
        {
            id: 10, 
            title: "رهن الدرع عند يهودي", 
            source: "البخاري/مسلم", 
            sourceUrl: "https://dorar.net/h/MSQnHmDE",
            text: `تُوُفِّيَ رَسولُ اللَّهِ صَلَّى اللهُ عليه وسلَّمَ ودِرْعُهُ مَرْهُونَةٌ عِنْدَ يَهُودِيٍّ، بثَلَاثِينَ صَاعًا مِن شَعِيرٍ.`, 
            num: "2916",
            secondHadithText: `لأُخْرِجَنَّ اليَهُودَ، والنَّصارَى مِن جَزِيرَةِ العَرَبِ حتَّى لا أدَعَ إلَّا مُسْلِمًا.`,
            secondHadithNum: "1767",
            secondHadithUrl: "https://dorar.net/h/GFnmXko1",
            reason: `يظهر التناقض هنا في الحالة التي كان عليها اليهود في أواخر حياة النبي؛ فبينما تؤكد الرواية الأولى أن النبي مات وهو "مدين" ليهودي ورهن عنده درعه (مما يستلزم وجود اليهود في المدينة وتجارتهم وتعايشهم مع المسلمين حتى لحظة وفاته)، تدعي الرواية الثانية أن النبي قرر وأمر بإخراج جميع اليهود والنصارى من جزيرة العرب وتطهيرها منهم. فمن الناحية المنطقية، إذا كان النبي قد عزم على إخراجهم ولم يترك فيها إلّا مسلماً، فكيف يرهن درعه الحربي عند واحد منهم؟ وإذا كان اليهود قد أُخرجوا فعلاً، فمن هو ذلك اليهودي الذي بقي ليرهن عنده النبي درعه؟`
        },
        {
            id: 11, 
            title: "التعذيب بالمسامير المحماة", 
            source: "البخاري/البخاري", 
            sourceUrl: "https://dorar.net/h/4pjsHZV4",
            text: `قَدِمَ رَهْطٌ مِن عُكْلٍ علَى النبيِّ صَلَّى اللهُ عليه وسلَّمَ، كَانُوا في الصُّفَّةِ، فَاجْتَاوَوْا المَدِينَةَ، فَقالوا: يا رَسولَ اللَّهِ، أبْغِنَا رِسْلًا، فَقَالَ: ما أجِدُ لَكُمْ إلَّا أنْ تَلْحَقُوا بإبِلِ رَسولِ اللَّهِ فأتَوْهَا، فَشَرِبُوا مِن ألْبَانِهَا وأَبْوَالِهَا، حتَّى صَحُّوا وسَمِنُوا وقَتَلُوا الرَّاعِيَ واسْتَاقُوا الذَّوْدَ، فأتَى النبيَّ صَلَّى اللهُ عليه وسلَّمَ الصَّرِيخُ، فَبَعَثَ الطَّلَبَ في آثَارِهِمْ، فَما تَرَجَّلَ النَّهَارُ حتَّى أُتِيَ بهِمْ، فأمَرَ بمَسَامِيرَ فَأُحْمِيَتْ، فَكَحَلَهُمْ، وقَطَعَ أيْدِيَهُمْ وأَرْجُلَهُمْ وما حَسَمَهُمْ، ثُمَّ أُلْقُوا في الحَرَّةِ، يَسْتَسْقُونَ فَما سُقُوا حتَّى مَاتُوا. قَالَ أبو قِلَابَةَ: سَرَقُوا وقَتَلُوا وحَارَبُوا اللَّهَ ورَسولَهُ.`, 
            num: "6804",
            secondHadithText: `بَعَثَنَا رَسولَ اللَّهِ صَلَّى اللهُ عليه وسلَّمَ في بَعْثٍ فَقالَ: إنْ وجَدْتُمْ فُلَانًا وفُلَانًا فأحْرِقُوهُما بالنَّارِ، ثُمَّ قالَ رَسولُ اللَّهِ صَلَّى اللهُ عليه وسلَّمَ حِينَ أرَدْنَا الخُرُوجَ: إنِّي أمَرْتُكُمْ أنْ تُحْرِقُوا فُلَانًا وفُلَانًا، وإنَّ النَّارَ لا يُعَذِّبُ بهَا إلَّا اللَّهُ، فإنْ وجَدْتُمُوهُما فَاقْتُلُوهُمَا. <br><br> وفي رواية عند أبي داوود: لا يعذب بالنار إلّا رب النار المصدر <a href="https://dorar.net/h/2RFPof5e" target="_blank" style="color: blue; text-decoration: underline;">من هنا</a>`,
            secondHadithNum: "3016",
            secondHadithUrl: "https://dorar.net/h/SojHQrz2",
            reason: `يظهر التناقض الصارخ هنا في الوسيلة المستخدمة للعقاب؛ فبينما تقرر الرواية الثانية قاعدة تشريعية عامة ينهى فيها النبي عن استخدام النار في التعذيب أو القتل معتبراً ذلك حقاً حصرياً لخالق النار (رب النار)، تدعي الرواية الأولى أن النبي قام بنفسه بالتعذيب بالنار عبر طلب مسامير وإحمائها في النار حتى أصبحت تتوهج حرارة ثم كحل (سمل) بها أعين الأسرى وهم أحياء. فكيف ينهى النبي عن التعذيب بالنار في قولٍ ويُمارس أقصى درجات التعذيب بالنار المحماة في فعلٍ؟`
        },
        {
            id: 12, 
            title: "ضمان الجنة بالكلمة", 
            source: "البخاري/البخاري", 
            sourceUrl: "https://dorar.net/h/wPYgTePs",
            text: `ما مِن عَبْدٍ قالَ: لا إلَهَ إلَّا اللَّهُ، ثُمَّ مَاتَ علَى ذلكَ إلَّا دخَلَ الجَنَّةَ قُلتُ: وإنْ زَنَى وإنْ سَرَقَ؟ قالَ: وإنْ زَنَى وإنْ سَرَقَ قُلتُ: وإنْ زَنَى وإنْ سَرَقَ؟ قالَ: وإنْ زَنَى وإنْ سَرَقَ قُلتُ: وإنْ زَنَى وإنْ سَرَقَ؟ قالَ: وإنْ زَنَى وإنْ سَرَقَ علَى رَغْمِ أنْفِ أبِي ذَرٍّ وكانَ أبو ذَرٍّ إذَا حَدَّثَ بهذا قالَ: وإنْ رَغِمَ أنْفُ أبِي ذَرٍّ.`, 
            num: "5827",
            secondHadithText: `ما أَسْفَلَ مِنَ الكَعْبَيْنِ مِنَ الإزَارِ فَفِي النَّارِ.`,
            secondHadithNum: "5787",
            secondHadithUrl: "https://dorar.net/h/VXRYJJW9",
            reason: `يظهر التناقض هنا في معايير النجاة والاستحقاق للعقاب؛ فبينما تقرر الرواية الأولى "حصانة شاملة" لمشرع نطق بالشهادة، لدرجة أن الكبائر العظيمة (كالزنى والسرقة) لا تمنعه من دخول الجنة، تأتي الرواية الثانية لتتوعد المسلم بالنار لمجرد تفصيلة شكلية في لباسه (وهي طول الثوب أسفل الكعبين). فكيف يُعقل في منطق هذه الروايات أن يضمن السارق والزاني الجنة بمجرد القول، بينما يُحكم بالنار على شخص لمجرد أن ثوبه تجاوز كعبه، حتى وإن كان موحداً ولا يزني ولا يسرق؟`
        },
        {
            id: 13, 
            title: "الوقاية بالتمرات", 
            source: "البخاري/البخاري", 
            sourceUrl: "https://dorar.net/h/sPvK82vt",
            text: `مَن تَصَبَّحَ كُلَّ يَومٍ سَبْعَ تَمَراتٍ عَجْوَةً، لَمْ يَضُرَّهُ في ذلكَ اليَومِ سُمٌّ ولا سِحْرٌ.`, 
            num: "5445",
            secondHadithText: `بخصوص السحر: سُحِرَ النبيُّ صَلَّى اللهُ عليه وسلَّمَ، حتَّى كانَ يُخَيَّلُ إلَيْهِ أنَّه يَفْعَلُ الشَّيْءَ وما يَفْعَلُهُ. <br><br> وبخصوص السم: يا عائشةُ ما أزالُ أجِدُ ألم الطعامِ الذي أَكَلْتُ بخيبرَ، فهذا أوانُ وجدتُّ انقطاعَ أَبْهَرِي مِنْ ذلِكَ السُّمِّ المصدر <a href="https://dorar.net/h/mOMjIdtZ" target="_blank" style="color: blue; text-decoration: underline;">من هنا</a>`,
            secondHadithNum: "3268",
            secondHadithUrl: "https://dorar.net/h/TGdk3CJ6",
            reason: `يظهر التناقض هنا في فعالية "الوقاية" التي بشّرت بها الرواية الأولى؛ فبينما تضع الرواية الأولى قاعدة طبية غيبية تجزم بأن من يأكل سبع تمرات في الصباح يتمتع بحصانة كاملة من السم والسحر طوال اليوم، تخبرنا الروايات الأخرى في نفس الكتاب أن النبي قد وقع ضحية للسحر حتى اختل وعيه، وضحية للسم الذي وضعه له اليهود في خيبر وظل يتألم منه حتى وفاته. فإذا كان التمر يمنع أثر السحر والسم بنص الرواية، فكيف سُحر وتعرض للسم صاحب الرواية نفسه؟ وإذا لم يحمه التمر وهو النبي، فكيف يُبشر الآخرين بأنه سيحميهم؟`
        },
        {
            id: 14, 
            title: "تحريم سباب المسلم", 
            source: "البخاري/مسلم", 
            sourceUrl: "https://dorar.net/h/m5ExSM5n",
            text: `سِبابُ المُسْلِمِ فُسُوقٌ، وقِتالُهُ كُفْرٌ.`, 
            num: "7076",
            secondHadithText: `دَخَلَ علَى رَسُولِ اللهِ صَلَّى اللَّهُ عليه وَسَلَّمَ رَجُلَانِ فَكَلَّمَاهُ بشَيءٍ، فأغْضَبَاهُ، فَلَعَنَهُمَا وَسَبَّهُمَا... قال: اللَّهُمَّ إنَّما أَنَا بَشَرٌ، فأيُّ المُسْلِمِينَ لَعَنْتُهُ أَوْ سَبَبْتُهُ، فَاجْعَلْهُ له زَكَاةً وَأَجْرًا.`,
            secondHadithNum: "2600",
            secondHadithUrl: "https://dorar.net/h/ArbUcvrj",
            reason: `يظهر التناقض هنا في السلوك الأخلاقي والتشريعي؛ فبينما تضع الرواية الأولى قاعدة أخلاقية صارمة تعتبر سب المسلم "فسوقاً"، تدعي الرواية الثانية أن النبي نفسه كان يسب ويلعن بعض المسلمين المؤمنين عندما يغضب، بل وتضع تبريراً لذلك بأن هذه المسبة واللعنة ستتحول إلى "زكاة وأجر" للمشتوم. فالتناقض يكمن في كيف ينهى النبي عن فعل ويصفه بالفسوق ثم يمارسه هو؟ وكيف يتحول الفسوق (السباب) إلى أجر وزكاة؟`
        },
        {
            id: 15, 
            title: "الحبة السوداء", 
            source: "البخاري/البخاري", 
            sourceUrl: "https://dorar.net/h/bjXeZe57",
            text: `فِي الحَبَّةِ السَّوْداءِ شِفاءٌ مِن كُلِّ داءٍ، إلَّا السَّامَ.`, 
            num: "5688",
            secondHadithText: `الشِّفاءُ في ثَلاثَةٍ: في شَرْطَةِ مِحْجَمٍ، أوْ شَرْبَةِ عَسَلٍ، أوْ كَيَّةٍ بنارٍ، وأنا أنْهَى أُمَّتي عَنِ الكَيِّ.`,
            secondHadithNum: "5681",
            secondHadithUrl: "https://dorar.net/h/cfbcOiba",
            reason: `يظهر التناقض هنا في تحديد وحصر مصادر الشفاء؛ فبينما تمنح الرواية الأولى "الحبة السوداء" صفة الشمولية المطلقة كعلاج لـ "كل داء"، تأتي الرواية الثانية لتحصر الشفاء في "ثلاثة" أمور فقط (الحجامة، العسل، الكي). فإذا كان الشفاء محصوراً في هذه الثلاثة، فأين ذهبت الحبة السوداء؟ هذا الاضطراب في حصر وسائل العلاج يوضح تناقضاً في المادة الطبية المنسوبة للنبي في الروايات.`
        },
        {
            id: 16, 
            title: "الأمر بقتل الكلاب", 
            source: "البخاري/البخاري", 
            sourceUrl: "https://dorar.net/h/Qzgm7vp3",
            text: `أنَّ رَسولَ اللَّهِ صَلَّى اللهُ عليه وسلَّمَ أمَرَ بقَتْلِ الكِلَابِ.`, 
            num: "3323",
            secondHadithText: `بيْنَما كَلْبٌ يُطِيفُ برَكِيَّةٍ، كادَ يَقْتُلُهُ العَطَشُ، إذْ رَأَتْهُ بَغِيٌّ مِن بَغايا بَنِي إسْرائِيلَ، فَنَزَعَتْ مُوقَها فَسَقَتْهُ فَغُفِرَ لها بهِ.`,
            secondHadithNum: "3467",
            secondHadithUrl: "https://dorar.net/h/gnzn6z29",
            reason: `يظهر التناقض هنا في التقييم التشريعي والأخلاقي لهذا الكائن (الكلب)؛ فبينما تُصوّر الرواية الأولى الكلب ككائن مستباح الدم يجب إبادته وقتله بأمر نبوي، تُصوّر الرواية الثانية الكلب ككائن ذي روح محترمة يستحق الرحمة، لدرجة أن سقي كلب واحد كان سبباً كافياً لغفران كبائر الذنوب وفتح أبواب الجنة لامرأة زانية. فالتناقض يكمن في كيف يُؤمر بقتل أمة من الأمم (الكلاب) في نص، بينما يُجعل إنقاذ فرد واحد من هذه الأمة عملاً بطولياً يؤدي للنجاة من النار في نص آخر؟`
        },
        {
            id: 17, 
            title: "إباحة قتل النساء والذرية", 
            source: "البخاري/البخاري", 
            sourceUrl: "https://dorar.net/h/bYbPLiGw",
            text: `مَرَّ بيَ النَّبيُّ صَلَّى اللهُ عليه وسلَّمَ بالأبْوَاءِ -أوْ بوَدَّانَ- وسُئِلَ عن أهْلِ الدَّارِ يُبَيَّتُونَ مِنَ المُشْرِكِينَ، فيُصَابُ مِن نِسَائِهِمْ وذَرَارِيِّهِمْ، قالَ: هُمْ منهمْ، وسَمِعْتُهُ يقولُ: لا حِمَى إلَّا لِلَّهِ ولِرَسولِهِ صَلَّى اللهُ عليه وسلَّمَ.`, 
            num: "3012",
            secondHadithText: `وُجِدَتِ امْرَأَةٌ مَقْتُولَةً في بَعْضِ مَغَازِي رَسولِ اللَّهِ صَلَّى اللهُ عليه وسلَّمَ، فَنَهَى رَسولُ اللَّهِ صَلَّى اللهُ عليه وسلَّمَ عن قَتْلِ النِّسَاءِ والصِّبْيَانِ.`,
            secondHadithNum: "3015",
            secondHadithUrl: "https://dorar.net/h/E9azmHTI",
            reason: `يظهر التناقض هنا في حرمة دماء غير المقاتلين (النساء والأطفال)؛ فبينما تضع الرواية الثانية منعاً قاطعاً وقاعدة أخلاقية تحرم قتل النساء والصبيان في الحروب، تأتي الرواية الأولى لتبيح دماءهم بدم بارد تحت ذريعة البيات (الهجوم الليلي)، مبررة ذلك بجملة (هم منهم) أي أنهم جزء من العدو ولا حرج في قتلهم معهم. فكيف ينهى النبي عن فعل ويراه منكراً في الرواية الثانية، ثم يشرعنه ويبرر وقوعه في الرواية الأولى؟`
        },
        {
            id: 18, 
            title: "وصية النبي قبل وفاته", 
            source: "البخاري/البخاري", 
            sourceUrl: "https://dorar.net/h/yUbUpWIt",
            text: `سَأَلْتُ عَبْدَ اللَّهِ بنَ أبِي أوْفَى رَضِيَ اللَّهُ عنْهما هلْ كانَ النبيُّ صَلَّى اللهُ عليه وسلَّمَ أوْصَى؟ فَقالَ: لَا، فَقُلتُ: كيفَ كُتِبَ علَى النَّاسِ الوَصِيَّةُ أوْ أُمِرُوا بالوَصِيَّةِ؟ قالَ: أوْصَى بكِتَابِ اللَّهِ.`, 
            num: "2740",
            secondHadithText: `قالَ ابنُ عبَّاسٍ: يَوْمُ الخَمِيسِ... فقالَ: ائْتُونِي أكْتُبْ لَكُمْ كِتابًا لَنْ تَضِلُّوا بَعْدَهُ أبَدًا... وأَوْصاهُمْ بثَلاثٍ: أخْرِجُوا المُشْرِكِينَ مِن جَزِيرَةِ العَرَبِ، وأَجِيزُوا الوَفْدَ بنَحْوِ ما كُنْتُ أُجِيزُهُمْ وسَكَتَ عَنِ الثَّالِثَةِ أوْ قالَ فَنَسِيتُها.`,
            secondHadithNum: "4431",
            secondHadithUrl: "https://dorar.net/h/mWrEUBxZ",
            reason: `يظهر التناقض هنا في نفي وإثبات وقوع الوصية من النبي؛ فبينما تجزم الرواية الأولى جزماً قاطعاً على لسان أحد كبار الصحابة بأن النبي لم يوصِ بأي شيء سوى التمسك بالقرآن، تأتي الرواية الثانية لتؤكد أن النبي قد أوصى وصية صريحة تضمنت ثلاثة أوامر محددة. فكيف يجهل رواة الرواية الأولى وجود وصايا سياسية واجتماعية هامة نطق بها النبي على فراش الموت؟ وكيف يستقيم القول بأنه لم يوصِ إلّا بالكتاب، مع وجود روايات تفصل وصايا أخرى في نفس الكتب؟`
        },
        {
            id: 19, 
            title: "قدر الجنين ومراحل خلقه", 
            source: "البخاري/البخاري", 
            sourceUrl: "https://dorar.net/h/pSl1YDTv",
            text: `أنَّ خَلْقَ أحَدِكُمْ يُجْمَعُ في بَطْنِ أُمِّهِ أرْبَعِينَ يَوْمًا أوْ أرْبَعِينَ لَيْلَةً، ثُمَّ يَكونُ عَلَقَةً مِثْلَهُ، ثُمَّ يَكونُ مُضْغَةً مِثْلَهُ، ثُمَّ يُبْعَثُ إلَيْهِ المَلَكُ فيُؤْذَنُ بأَرْبَعِ كَلِماتٍ، فَيَكْتُبُ: رِزْقَهُ، وأَجَلَهُ، وعَمَلَهُ، وشَقِيٌّ أمْ سَعِيدٌ، ثُمَّ يَنْفُخُ فيه الرُّوحَ...`, 
            num: "7454",
            secondHadithText: `إنَّ اللَّهَ وكَّلَ في الرَّحِمِ مَلَكًا، فيَقولُ: يا رَبِّ نُطْفَةٌ، يا رَبِّ عَلَقَةٌ، يا رَبِّ مُضْغَةٌ، فإذا أرادَ أنْ يَخْلُقَها قالَ: يا رَبِّ أذَكَرٌ، يا رَبِّ أُنْثَى، يا رَبِّ شَقِيٌّ أمْ سَعِيدٌ، فَما الرِّزْقُ، فَما الأجَلُ، فيُكْتَبُ كَذلكَ في بَطْنِ أُمِّهِ.`,
            secondHadithNum: "3333",
            secondHadithUrl: "https://dorar.net/h/EHLP4q1j",
            reason: `يظهر التناقض هنا في توقيت إرسال الملك وفي آلية كتابة القدر؛ فبينما تجزم الرواية الأولى بأن الملك لا يُبعث إلى الجنين إلّا بعد مرور 120 يوماً (ثلاثة أربعينات) ليكتب قدره وينفخ فيه الروح، تؤكد الرواية الثانية أن الملك مُوكّل بالرحم منذ البداية، وأنه يواكب الجنين في كل مرحلة، وأن كتابة القدر تتم فور إرادة الله قضاء خلقه وتشكيله، وليس بالضرورة بعد انتظار 120 يوماً. هذا الاضطراب يضع الروايتين في حالة تصادم زمني ومنطقي واضح.`
        },
        {
            id: 20, 
            title: "عمر النبي عند وفاته", 
            source: "البخاري/البخاري", 
            sourceUrl: "https://dorar.net/h/HEJ1t7WS",
            text: `كانَ رَسولُ اللَّهِ صَلَّى اللهُ عليه وسلَّمَ ليسَ بالطَّوِيلِ البَائِنِ، ولَا بالقَصِيرِ، وليسَ بالأبْيَضِ الأمْهَقِ، وليسَ بالآدَمِ، وليسَ بالجَعْدِ القَطَطِ، ولَا بالسَّبْطِ، بَعَثَهُ اللَّهُ علَى رَأْسِ أرْبَعِينَ سَنَةً، فأقَامَ بمَكَّةَ عَشْرَ سِنِينَ، وبِالْمَدِينَةِ عَشْرَ سِنِينَ، وتَوَفَّاهُ اللَّهُ علَى رَأْسِ سِتِّينَ سَنَةً، وليسَ في رَأْسِهِ ولِحْيَتِهِ عِشْرُونَ شَعَرَةً بَيْضَاءَ.`, 
            num: "5900",
            secondHadithText: `أنَّ النبيَّ صَلَّى اللهُ عليه وسلَّمَ: تُوُفِّيَ، وهو ابنُ ثَلَاثٍ وسِتِّينَ. <br><br> وفي رواية ثانية: أَقَامَ بمَكَّةَ ثَلَاثَ عَشْرَةَ سَنَةً يُوحَى إلَيْهِ، وَبِالْمَدِينَةِ عَشْرًا وَمَاتَ، وَهو ابنُ ثَلَاثٍ وَسِتِّينَ سَنَةً المصدر <a href="https://dorar.net/h/kVvthjZw" target="_blank" style="color: blue; text-decoration: underline;">من هنا</a>`,
            secondHadithNum: "3536",
            secondHadithUrl: "https://dorar.net/h/zuwghRcB",
            reason: `يظهر التناقض هنا في تحديد أدق تفاصيل السيرة النبوية وهي عُمره عند وفاته ومدة إقامته في مكة بعد البعثة؛ فبينما تجزم الرواية الأولى (رواية أنس) بأن النبي أقام بمكة عشر سنين فقط وتوفي وعمره ستون سنة، تؤكد الرواية الثانية (رواية عائشة وابن عباس) أنه توفي وعمره ثلاث وستون سنة، مما يعني أنه أقام بمكة ثلاث عشرة سنة. هذا الاختلاف في الرقم (60 مقابل 63) ليس مجرد تفصيل بسيط، بل هو تضارب في الجدول الزمني للرسالة وفي عُمر النبي، وكلاهما مروي في "أصح الكتب" وعن أقرب الصحابة إليه، مما يوضح اضطراب الرواة حتى في أرقام السنين الأساسية.`
         },
         {
            id: 21, 
            title: "تناقض الروايات في الوضوء", 
            source: "مسلم/النسائي", 
            sourceUrl: "https://dorar.net/h/faeYgR3g",
            text: `قالَ رَسولُ اللهِ صَلَّى اللَّهُ عليه وسلَّمَ: تَوَضَّؤُوا ممَّا مَسَّتِ النَّارُ. (أي يجب الوضوء بعد أكل أي طعام طُبخ على النار).`, 
            num: "353",
            secondHadithText: `كانَ آخِرُ الأمرَينِ مِن رسولِ اللَّهِ ، تَرْكَ الوضوءِ ، مِمَّا مسَّتِ النَّارُ. <br><br> وفي رواية ثانية عند البخاري: (أن النبي أكل كتف شاة ثم صلى ولم يتوضأ) المصدر <a href="https://dorar.net/h/A9O8bb1I" target="_blank" style="color: blue; text-decoration: underline;">من هنا</a>`,
            secondHadithNum: "185",
            secondHadithUrl: "https://dorar.net/h/7Ltoelpw",
            reason: `يظهر التناقض هنا في حكم شرعي يتعلق بالطهارة اليومية؛ فالرواية الأولى تضع أمراً نبوياً صريحاً بوجوب الوضوء من كل ما مسته النار، بينما تنفي الرواية الثانية هذا الوجوب وتؤكد أن النبي فعل العكس في أواخر حياته وصلى دون وضوء بعد أكل اللحم المطبوخ. هذا التضارب جعل المسلمين في حيرة، واضطر الفقهاء لادعاء "النسخ" لحل التناقض بين قول النبي وفعله المرويَّين في الصحاح.`
        },
        {
            id: 22, 
            title: "زواج النبي من ميمونة", 
            source: "البخاري/ابن حبان", 
            sourceUrl: "https://dorar.net/h/P2dwZl5i",
            text: `أنَّ النبيَّ صَلَّى اللهُ عليه وسلَّمَ تَزَوَّجَ مَيْمُونَةَ وهو مُحْرِمٌ. (أي وهو في حالة الإحرام للعمرة).`, 
            num: "1837",
            secondHadithText: `أنَّ رسولَ اللهِ صلَّى اللهُ عليه وسلَّم تزوَّج ميمونةَ وهو حلالٌ وبنى بها وهو حلالٌ وكُنْتُ الرَّسولَ بينَهما. <br><br> وفي رواية أبي داوود عن ميمونة نفسها: (تزوجني ونحن حلالان) المصدر <a href="https://dorar.net/h/JRJ2Zopv" target="_blank" style="color: blue; text-decoration: underline;">من هنا</a>`,
            secondHadithNum: "4135",
            secondHadithUrl: "https://dorar.net/h/lyRk3van",
            reason: `يظهر التناقض هنا في واقعة تاريخية وتشريعية هامة؛ فبينما يجزم ابن عباس بأن النبي خالف النهي عن نكاح المحرم وتزوج وهو مُحرم، يجزم أبو رافع (صاحب القصة) وصاحبة الشأن "ميمونة" بأن الزواج تم وهما في حالة "حِل" وليس إحراماً. هذا التضارب في النقل أدى إلى اختلاف الفقهاء؛ فمنهم من أباح زواج المحرم بناءً على الرواية الأولى، ومنهم من حرّمه بناءً على الرواية الثانية، مما يثبت عدم دقة الرواة في نقل تفاصيل حياة النبي الخاصة.`
        },
        {
            id: 23, 
            title: "صلاة النبي داخل الكعبة", 
            source: "الترمذي/النسائي", 
            sourceUrl: "https://dorar.net/h/x4k4PTyf",
            text: `أنَّ النَّبيَّ صلَّى اللَّهُ عليهِ وسلَّمَ صلَّى في جَوفِ الكعبةِ`, 
            num: "874",
            secondHadithText: `لم يُصلِّ النَّبيُّ صلَّى اللَّهُ علَيهِ وسلَّمَ في الكَعبةِ ، ولَكِنَّهُ كبَّرَ في نواحيهِ`,
            secondHadithNum: "2913",
            secondHadithUrl: "https://dorar.net/h/uZuBV5yj",
            reason: `يظهر التناقض هنا في مشهد رآه الصحابة الذين دخلوا مع النبي إلى داخل الكعبة في فتح مكة؛ فبينما ينقل بلال أن النبي صلى ركعتين داخلها، ينقل الفضل بن عباس (الذي كان موجوداً أيضاً) أن النبي لم يصلِّ أصلاً واكتفى بالدعاء. هذا التضارب في نقل فعل نبوي ظاهر في مكان ضيق وبحضور عدد قليل من الصحابة يوضح كيف يختلف الرواة في رؤية ونقل نفس الواقعة في نفس اللحظة.`
        },
        {
            id: 24, 
            title: "الوضوء من لحم الإبل", 
            source: "مسلم/المجموع", 
            sourceUrl: "https://dorar.net/h/mOB78cx3",
            text: `أنَّ رَسولَ اللهِ صَلَّى اللَّهُ عليه وسلَّمَ أأَتَوَضَّأُ مِن لُحُومِ الغَنَمِ؟ قالَ: إنْ شِئْتَ فَتَوَضَّأْ، وإنْ شِئْتَ فلا تَوَضَّأْ قالَ أتَوَضَّأُ مِن لُحُومِ الإبِلِ؟ قالَ: نَعَمْ فَتَوَضَّأْ مِن لُحُومِ الإبِلِ قالَ: أُصَلِّي في مَرَابِضِ الغَنَمِ؟ قالَ: نَعَمْ قالَ: أُصَلِّي في مَبَارِكِ الإبِلِ؟ قالَ: لَا.`, 
            num: "360",
            secondHadithText: `عنِ ابنِ عبَّاسٍ رَضِي اللَّهُ عنهُما: إِنَّما الوُضوءُ ممَّا يخرجُ وليسَ مما يدخلُ ، وإنما الفِطرُ مما دخلَ وليسَ مما خرجَ.`,
            secondHadithNum: "6/317",
            secondHadithUrl: "https://dorar.net/h/61cbhnM3",
            reason: `يظهر التناقض هنا في قاعدة الطهارة؛ فالرواية الأولى توجب الوضوء من أكل لحم الإبل تحديداً، بينما تضع الرواية الثانية قاعدة عامة ومنطقية بأن الوضوء يكون بسبب ما يخرج من الجسد (الخارج من السبيلين) وليس بسبب ما يدخل إليه من طعام (لحم إبل أو غيره). هذا التضارب أدى لشرخ فقهي مستمر، حيث يوجب بعضهم الوضوء من لحم الإبل بينما يراه الآخرون طعاماً كغيره لا ينقض الوضوء.`
        }
    ];

    let currentPage = 1;
    const perPage = 15;
    let currentFontSizeRem = 1.15;

    function normalizeArabic(text) {
        if (!text) return "";
        return text
            .replace(/[\u064B-\u065F]/g, "") 
            .replace(/[أإآ]/g, "ا")           
            .replace(/ة/g, "ه")               
            .replace(/ى/g, "ي")               
            .trim();
    }

    function highlightText(text, query) {
        if (!query) return text;
        
        const regex = new RegExp(`(${query.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
        return text.replace(regex, '<mark>$1</mark>');
    }

    function toggleMobileMenu() {
        const links = document.getElementById('navLinks');
        const overlay = document.getElementById('navOverlay');
        links.classList.toggle('show');
        overlay.style.display = links.classList.contains('show') ? 'block' : 'none';
        document.body.classList.toggle('no-scroll');
    }

    function performSearch() {
        const query = normalizeArabic(document.getElementById('globalSearch').value.toLowerCase());
        const resultsContainer = document.getElementById('searchResults');
        resultsContainer.innerHTML = '';
        resultsContainer.style.display = 'none';

        if (query === '') return;

        let results = [];
        novelsData.forEach((novel, index) => {
            const searchField = normalizeArabic(novel.title + novel.text + novel.reason + novel.secondHadithText).toLowerCase();
            if (searchField.includes(query)) {
                results.push({ ...novel, originalIndex: index });
            }
        });

        if (results.length === 0) {
            resultsContainer.innerHTML = '<div class="search-item" style="text-align:center; color:#888;">لا توجد نتائج</div>';
            resultsContainer.style.display = 'block';
            return;
        }

        results.slice(0, 10).forEach(result => {
            const item = document.createElement('div');
            item.className = 'search-item';
            
            // تمييز النص في النتائج
            const highlightedTitle = highlightText(result.title, query);
            const highlightedSource = highlightText(result.source, query);
            
            item.innerHTML = `<strong>${highlightedTitle}</strong><br><small>${highlightedSource}</small>`;
            item.onclick = () => {
                jumpToNovel(result.originalIndex, result.id, query);
                resultsContainer.style.display = 'none';
                document.getElementById('globalSearch').value = '';
            };
            resultsContainer.appendChild(item);
        });
        resultsContainer.style.display = 'block';
    }

    function jumpToNovel(index, id, searchQuery = null) {
        currentPage = Math.floor(index / perPage) + 1;
        renderNovels(searchQuery);
        setTimeout(() => {
            const card = document.getElementById(`card-h${id}`);
            if (card) {
                const details = card.querySelector('.hadith-details');
                if (!details.classList.contains('open')) {
                    toggleHadith(card.querySelector('.hadith-summary'));
                }
                card.scrollIntoView({ behavior: 'smooth', block: 'center' });
                card.style.boxShadow = "0 0 15px var(--primary-light)";
                setTimeout(() => card.style.boxShadow = "var(--shadow-sm)", 2000);
            }
        }, 300);
    }

    function renderNovels(searchQuery = null) {
        const container = document.getElementById('hadithContainer');
        container.innerHTML = "";
        const start = (currentPage - 1) * perPage;
        const end = start + perPage;
        const pageData = novelsData.slice(start, end);

        pageData.forEach((novel) => {
            // تمييز النص إذا كان هناك بحث
            let titleText = novel.title;
            let reasonText = novel.reason;
            let textText = novel.text;
            let secondHadithText = novel.secondHadithText;
            
            if (searchQuery) {
                titleText = highlightText(titleText, searchQuery);
                reasonText = highlightText(reasonText, searchQuery);
                textText = highlightText(textText, searchQuery);
                secondHadithText = highlightText(secondHadithText, searchQuery);
            }

            container.innerHTML += `
            <div class="hadith-row">
                <div class="hadith-number-circle">${novel.id}</div>
                <div class="hadith-card" id="card-h${novel.id}">
                    <i class="far fa-bookmark fav-header-icon" title="أضف للمفضلة" onclick="toggleFavorite(event, ${novel.id})"></i>
                    <div class="hadith-summary" onclick="toggleHadith(this)">
                        <h3>${titleText}</h3>
                        <div style="display:flex; align-items:center; gap:12px;">
                            <span class="source-tag">${novel.source}</span>
                            <i class="fas fa-chevron-down toggle-icon"></i>
                        </div>
                    </div>
                    <div class="hadith-details">
                        <div class="detail-section">
                            <div class="section-header"><i class="fas fa-quote-right"></i> الرواية (1)</div>
                            <div class="section-content">${textText}</div>
                            ${novel.num ? `<div class="section-content"><b style="font-weight: bold;">رقم الرواية: ${novel.num}</b></div>` : ''}
                            <div class="hadith-actions">
                                <a href="${novel.sourceUrl}" target="_blank" class="action-btn btn-source"><i class="fas fa-external-link-alt"></i> مصدر الرواية</a>
                                <div class="action-btn btn-report" onclick="openReportModal('${novel.title} - الرواية (1)', '${novel.num}')"><i class="fas fa-flag"></i> إبلاغ</div>
                            </div>
                        </div>
                        <div class="detail-section">
                            <div class="section-header"><i class="fas fa-quote-right"></i> الرواية (2)</div>
                            <div class="section-content">${secondHadithText}</div>
                            ${novel.secondHadithNum ? `<div class="section-content"><b style="font-weight: bold;">رقم الرواية: ${novel.secondHadithNum}</b></div>` : ''}
                            <div class="hadith-actions">
                                <a href="${novel.secondHadithUrl}" target="_blank" class="action-btn btn-source"><i class="fas fa-external-link-alt"></i> مصدر الرواية</a>
                                <div class="action-btn btn-report" onclick="openReportModal('${novel.title} - الرواية (2)', '${novel.secondHadithNum || ''}')"><i class="fas fa-flag"></i> إبلاغ</div>
                            </div>
                        </div>
                        <div class="detail-section">
                            <div class="section-header"><i class="fas fa-exclamation-triangle"></i> وجه التناقض</div>
                            <div class="section-content">${reasonText}</div>
                        </div>
                    </div>
                </div>
            </div>`;
        });
        updatePaginationUI();
        syncFavIcons();
    }

    function toggleHadith(el) {
        const details = el.nextElementSibling;
        const row = el.closest('.hadith-row');
        details.classList.toggle('open');
        row.classList.toggle('is-open');
        const icon = el.querySelector('.toggle-icon');
        if(icon) icon.style.transform = details.classList.contains('open') ? 'rotate(180deg)' : 'rotate(0deg)';
    }

    function toggleFavorite(e, id) {
        e.stopPropagation();
        
        // إنشاء مفتاح فريد لكل رواية
        // نضيف البادئة 'novel_' لتمييز روايات هذا القسم عن غيرها
        const cardId = 'novel_' + id;
        
        let favs = JSON.parse(localStorage.getItem('myFavorites')) || [];
        const idx = favs.findIndex(f => f.id === cardId);

        if (idx > -1) {
            favs.splice(idx, 1);
        } else {
            const novel = novelsData.find(n => n.id == id);
            favs.push({ 
                id: cardId, 
                title: novel.title, 
                type: 'رواية',
                novelId: id,
                page: 'hadith'
            });
        }

        localStorage.setItem('myFavorites', JSON.stringify(favs));
        syncFavIcons();
    }

    function syncFavIcons() {
        const favs = JSON.parse(localStorage.getItem('myFavorites')) || [];
        
        document.querySelectorAll('.fav-header-icon').forEach(icon => {
            const onclickAttr = icon.getAttribute('onclick');
            const idMatch = onclickAttr.match(/toggleFavorite\(event,\s*(\d+)\)/);
            
            if (idMatch) {
                // استخدام نفس المفتاح الفريد للبحث
                const cardId = 'novel_' + idMatch[1];
                const isFav = favs.some(f => f.id === cardId);
                
                icon.classList.toggle('fas', isFav);
                icon.classList.toggle('far', !isFav);
                icon.style.color = isFav ? "var(--primary-color)" : "var(--matte-purple)";
            }
        });
    }

    function updateFontSize() {
        document.documentElement.style.setProperty('--dynamic-content-size', currentFontSizeRem + 'rem');
    }

    document.getElementById('fontIncrease').onclick = () => { currentFontSizeRem += 0.1; updateFontSize(); };
    document.getElementById('fontDecrease').onclick = () => { if(currentFontSizeRem > 0.8) currentFontSizeRem -= 0.1; updateFontSize(); };
    document.getElementById('fontReset').onclick = () => { currentFontSizeRem = 1.15; updateFontSize(); };

    function updatePaginationUI() {
        const totalPages = Math.ceil(novelsData.length / perPage);
        const totalHadiths = novelsData.length;
        
        document.getElementById('pageInfo').textContent = `الصفحة ${currentPage} من ${totalPages}`;
        document.getElementById('totalHadithCount').textContent = `عدد الروايات: ${totalHadiths}`;
        
        document.getElementById('prevPage').disabled = (currentPage === 1);
        document.getElementById('nextPage').disabled = (currentPage === totalPages);
        document.getElementById('firstPage').disabled = (currentPage === 1);
    }

    document.getElementById('nextPage').onclick = () => { currentPage++; renderNovels(); window.scrollTo(0, 400); };
    document.getElementById('prevPage').onclick = () => { currentPage--; renderNovels(); window.scrollTo(0, 400); };
    document.getElementById('firstPage').onclick = () => { currentPage = 1; renderNovels(); window.scrollTo(0, 400); };

    function openReportModal(title, num) {
        document.getElementById('hiddenHadithName').value = title;
        document.getElementById('hiddenHadithNumber').value = num;
        document.getElementById('modalHadithInfo').textContent = `أنت تبلغ عن: ${title} ${num ? '(رواية رقم ' + num + ')' : ''}`;
        document.getElementById('reportModal').classList.add('show');
        document.body.classList.add('no-scroll');
    }
    
    function closeReportModal() {
        document.getElementById('reportModal').classList.remove('show');
        document.body.classList.remove('no-scroll');
    }

    document.getElementById("reportForm").addEventListener("submit", function(e) {
        e.preventDefault();
        const formData = new FormData(this);
        fetch("/", {
            method: "POST",
            headers: { "Content-Type": "application/x-www-form-urlencoded" },
            body: new URLSearchParams(formData).toString(),
        }).then(() => {
            closeReportModal();
            const toast = document.getElementById("successToast");
            toast.classList.add("show");
            setTimeout(() => toast.classList.remove("show"), 3500);
            this.reset();
        });
    });

    window.addEventListener('scroll', () => {
        const btt = document.getElementById('backToTop');
        if (window.scrollY > 400) btt.classList.add('show');
        else btt.classList.remove('show');
    });

    document.getElementById('backToTop').onclick = () => window.scrollTo({ top: 0, behavior: 'smooth' });
    document.getElementById('globalSearch').addEventListener('input', performSearch);

    document.addEventListener('DOMContentLoaded', () => {
        renderNovels();
        updateFontSize();
    });
</script>
</body>
</html>
