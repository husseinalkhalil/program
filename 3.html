<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport"/>
    <title>الروايات - روايات تناقض بعضها</title>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4459876088599546" crossorigin="anonymous"></script>
    
    <!-- Favicon -->
    <link href="images/logo-small.png" rel="icon" type="image/png"/>
    <link href="images/logo-small.png" rel="apple-touch-icon"/>

    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --primary-color: #5e2ca5;
            --primary-dark: #451b7a; 
            --primary-light: #8a5bc7;
            --accent-color: #ffd700;
            --bg-color: #f9f7f2;
            --surface-color: #F8F5FD; 
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --shadow-sm: 0 4px 15px rgba(94, 44, 165, 0.08);
            --shadow-md: 0 8px 20px rgba(94, 44, 165, 0.12);
            --shadow-lg: 0 15px 30px rgba(0,0,0,0.1);
            --radius-lg: 1rem;
            --radius-xl: 1.5rem;
            --number-border: #8E13BB; 
            --matte-purple: #7c5295; 
            --reading-beige: #FCF9F1; 
            --btt-bg: #8E13BB;
            --btt-accent: #FFC600;
            
            /* متغير التحكم بحجم الخط للمحتوى */
            --dynamic-content-size: 1.15rem;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Tajawal', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            width: 100%;
        }

        body.no-scroll {
            overflow: hidden !important;
            height: 100vh;
            position: fixed;
            width: 100%;
        }

        a { text-decoration: none; color: inherit; transition: all 0.3s ease; }

        /* ==================== Navigation ==================== */
        .nav-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.6); backdrop-filter: blur(4px);
            z-index: 998; display: none;
        }

        nav {
            background: rgba(94, 44, 165, 0.98);
            backdrop-filter: blur(10px);
            padding: 0 5%;
            position: fixed;
            width: 100%; top: 0; z-index: 1000;
            display: flex; align-items: center; justify-content: space-between;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            height: 75px;
        }

        .logo-container { order: 1; }
        .logo-container img { height: 45px; width: auto; transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275), filter 0.4s ease; }

        .nav-links {
            display: flex; flex: 1; justify-content: space-evenly; align-items: center; margin: 0 10px; order: 2;
        }

        .nav-links a {
            color: white; font-weight: 700; font-size: 0.95rem; padding: 8px 12px; border-radius: 20px; white-space: nowrap;
            display: flex; align-items: center; gap: 5px;
        }

        .nav-links a:hover, .nav-links a.active { background: rgba(255,255,255,0.15); transform: translateY(-2px); }

        .hamburger { display: none; color: white; font-size: 1.5rem; cursor: pointer; order: 3; }

        @media (max-width: 1200px) {
            .hamburger { display: block; order: 1; }
            .logo-container { order: 2; }
            .nav-links {
                position: fixed; top: 75px; right: -280px; width: 280px;
                background: var(--surface-color);
                flex-direction: column; padding: 20px; height: calc(100vh - 75px);
                box-shadow: -5px 0 15px rgba(0,0,0,0.1); transition: right 0.3s ease;
                overflow-y: auto; flex-wrap: nowrap; justify-content: flex-start;
                gap: 10px; margin: 0; flex: unset; z-index: 1000; display: flex !important;
            }
            .nav-links.show { right: 0; }
            .nav-links a { 
                color: var(--text-primary); width: 100%; padding: 12px; 
                border-radius: 8px; font-size: 1rem; justify-content: flex-start; 
                border-bottom: 1px solid rgba(0,0,0,0.03);
            }
            .nav-links a:hover { background: rgba(94, 44, 165, 0.05); color: var(--primary-color); transform: none; }
        }

        /* ==================== Header & Search ==================== */
        .unified-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
            padding: 100px 0 40px; border-radius: 0 0 50px 50px; margin-bottom: 30px;
            width: 100%; text-align: center; color: white; position: relative; z-index: 1;
        }
        .page-title { font-size: 2.2rem; font-weight: 800; margin-bottom: 10px; }
        .page-subtitle { color: #e2e8f0; font-size: 1.1rem; max-width: 800px; margin: 0 auto; padding: 0 20px; }

        .universal-search { width: 100%; max-width: 600px; margin: 35px auto 0; position: relative; z-index: 1002; }
        #globalSearch { 
            width: 100%; padding: 18px 25px; border-radius: 50px; border: none; font-size: 1rem; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.2); outline: none; text-align: right;
            font-family: 'Tajawal', sans-serif;
        }
        .search-results {
            position: absolute; top: 110%; left: 0; right: 0; 
            background: white; border-radius: 15px; max-height: 400px; 
            overflow-y: auto; display: none; z-index: 1002; color: #333; 
            text-align: right; box-shadow: var(--shadow-lg); border: 1px solid rgba(0,0,0,0.05);
        }
        .search-item { padding: 15px 20px; border-bottom: 1px solid rgba(0,0,0,0.05); cursor: pointer; transition: background 0.2s; }
        .search-item:hover { background: rgba(94, 44, 165, 0.05); }
        mark { background-color: #ffd700; color: #000; padding: 0 2px; border-radius: 2px; }

        /* ==================== Hadith Card Styling ==================== */
        .container { max-width: 1150px; margin: 0 auto; padding: 0 20px 60px; width: 100%; }
        .hadith-row { display: flex; align-items: flex-start; gap: 20px; margin-bottom: 30px; width: 100%; transition: all 0.3s ease; }
        
        .hadith-number-circle { 
            width: 46px; height: 46px; background-color: #FFC600; border: 2.5px solid #8E13BB; 
            color: #8E13BB; border-radius: 50%; display: flex; align-items: center; justify-content: center; 
            font-weight: 800; font-size: 1.3rem; flex-shrink: 0; box-shadow: 0 4px 8px rgba(0,0,0,0.1); 
            margin-top: 15px; padding-top: 4px; z-index: 5;
        }
        
        .hadith-card { 
            background: var(--surface-color); border-radius: var(--radius-xl); 
            box-shadow: var(--shadow-sm); border-right: 6px solid var(--primary-color); 
            overflow: hidden; transition: 0.3s; flex: 1; border: 1px solid rgba(0,0,0,0.05);
            position: relative; 
        }
        
        .hadith-summary { padding: 25px 25px 25px 45px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; gap: 15px; }
        .hadith-summary h3 { font-size: 1.3rem; color: var(--primary-dark); font-weight: 800; flex: 1; text-align: right; transition: all 0.3s ease; }
        .hadith-summary:hover h3 { color: #7c3aed; transform: translateX(-5px); }
        .source-tag { background: #FFC600; padding: 5px 12px; border-radius: 8px; font-size: 0.85rem; font-weight: 800; color: var(--primary-color); }
        
        .fav-header-icon { 
            font-size: 1.6rem; color: var(--matte-purple); transition: all 0.3s ease; cursor: pointer; 
            position: absolute; top: 0; left: 0; padding: 10px 15px; z-index: 10;
        }
        .fav-header-icon:hover { transform: scale(1.15); color: var(--primary-color); }
        .fav-header-icon.active { color: var(--primary-color); }

        .hadith-details { 
            max-height: 0; opacity: 0; overflow: hidden; 
            transition: max-height 0.7s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.5s ease-in-out; 
            background: var(--reading-beige); 
        }
        .hadith-details.open { max-height: 5000px; opacity: 1; padding: 10px 30px 50px; border-top: 1px solid rgba(0,0,0,0.05); }

        .detail-section { margin-top: 25px; background: transparent; border: none; }
        .section-header { 
            padding-bottom: 8px; margin-bottom: 10px; font-weight: 800; font-size: 1.1rem; 
            display: flex; align-items: center; gap: 10px; color: var(--primary-dark);
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }
        .section-content { padding: 5px 0 10px; line-height: 1.8; font-size: var(--dynamic-content-size); color: #334155; }

        .hadith-actions { display: flex; align-items: center; gap: 15px; margin-top: 25px; padding-top: 20px; border-top: 1px dashed rgba(0,0,0,0.08); }
        .action-btn { font-size: 0.9rem; font-weight: 700; padding: 10px 18px; border-radius: 8px; display: flex; align-items: center; gap: 8px; transition: 0.3s; cursor: pointer; text-decoration: none !important; }
        .btn-source { background: rgba(94, 44, 165, 0.1); color: var(--primary-color); border: 1px solid rgba(94, 44, 165, 0.2); }
        .btn-source:hover { background: var(--primary-color); color: white; }
        .btn-report { background: rgba(225, 29, 72, 0.08); color: #e11d48; border: 1px solid rgba(225, 29, 72, 0.1); }
        .btn-report:hover { background: #e11d48; color: white; }

        /* ==================== Font Controls & Back to top ==================== */
        .font-controls-fixed { position: fixed; top: 120px; left: 30px; display: flex; flex-direction: column; gap: 10px; z-index: 990; }
        .font-btn { width: 45px; height: 45px; border-radius: 50%; background: white; border: 1px solid #e2e8f0; color: var(--primary-color); cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 1.1rem; box-shadow: var(--shadow-sm); transition: 0.3s; }
        .font-btn:hover { background: var(--primary-color); color: white; transform: scale(1.1); }

        .back-to-top {
            position: fixed; bottom: 30px; right: 30px; width: 50px; height: 50px;
            background-color: var(--btt-bg); border: 3px solid var(--btt-accent);
            color: var(--btt-accent); border-radius: 50%; display: flex;
            align-items: center; justify-content: center; font-size: 1.2rem;
            cursor: pointer; z-index: 1001; transition: all 0.4s ease;
            opacity: 0; visibility: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .back-to-top.show { opacity: 1; visibility: visible; }
        .back-to-top:hover { transform: translateY(-5px) scale(1.05); background-color: var(--primary-dark); }

        /* ==================== Pagination ==================== */
        #pagination-wrapper { background: var(--surface-color); padding: 25px; border-radius: var(--radius-lg); box-shadow: var(--shadow-sm); text-align: center; margin: 40px auto; border: 1px solid rgba(0,0,0,0.05); max-width: 500px; }
        .pagination-btn { background: #f1f5f9; color: var(--text-primary); border: none; padding: 10px 20px; border-radius: 12px; cursor: pointer; margin: 0 5px; font-family: 'Tajawal'; font-weight: 600; transition: 0.3s; }
        .pagination-btn:hover { background: var(--primary-color); color: white; transform: translateY(-2px); }
        .pagination-btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; background: #e2e8f0; color: #94a3b8; }
        .pagination-info-container { display: flex; justify-content: center; align-items: center; gap: 20px; flex-wrap: wrap; margin-bottom: 15px; font-weight: 700; color: var(--text-primary); }
        .total-count-badge { background: var(--primary-color); color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.9rem; }

        /* ==================== Social Media ==================== */
        .social-section { text-align: center; margin-bottom: 60px; background: var(--surface-color); padding: 40px; border-radius: var(--radius-xl); box-shadow: var(--shadow-sm); margin-top: 50px; }
        .social-grid { display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; margin-top: 30px; }
        .social-btn { width: 55px; height: 55px; border-radius: 50%; display: flex; align-items: center; justify-content: center; background: white; transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .social-btn img { width: 26px; transition: 0.3s; }
        .social-btn:hover { transform: translateY(-8px) scale(1.1); box-shadow: 0 10px 20px rgba(0,0,0,0.15); }
        .social-btn:hover img { filter: brightness(0) invert(1); }
        .social-yt:hover { background: #FF0000; } 
        .social-fb:hover { background: #1877F2; } 
        .social-ins:hover { background: #E4405F; } 
        .social-tg:hover { background: #0088CC; } 
        .social-tk:hover { background: #000000; } 
        .social-sc:hover { background: #FFFC00; }

        /* ==================== Footer ==================== */
        footer { background: #1e293b; color: white; padding: 60px 20px; text-align: center; width: 100%; margin-top: 50px; }
        .footer-links { display: flex; justify-content: center; gap: 12px; margin-bottom: 25px; flex-wrap: wrap; align-items: center; }
        .footer-links a { color: #cbd5e1; font-weight: 500; font-size: 0.95rem; text-decoration: none; transition: color 0.3s ease; }
        .footer-links a:hover { color: var(--accent-color); }
        .footer-divider { color: #475569; font-size: 0.8rem; user-select: none; } 
        .copyright { color: #64748b; font-size: 0.85rem; border-top: 1px solid #334155; padding-top: 25px; margin-top: 25px; }

        /* ==================== Mobile Design ==================== */
        @media (max-width: 768px) {
            .hadith-summary h3 { font-size: 1.05rem !important; }
            .unified-header { padding: 90px 15px 40px; border-radius: 0 0 35px 35px; }
            .page-title { font-size: 1.7rem; }
            .hadith-row { flex-direction: row; align-items: flex-start; gap: 10px; }
            .hadith-row.is-open { flex-direction: column; }
            .hadith-row.is-open .hadith-number-circle { margin-top: 0; margin-bottom: 5px; align-self: flex-start; }
            .hadith-number-circle { width: 38px; height: 38px; font-size: 1rem; margin-top: 25px; }
            .hadith-card { width: 100%; }
            .hadith-details.open { padding: 15px 15px 40px; }
            .font-controls-fixed { left: 15px; top: auto; bottom: 20px; flex-direction: row; }
            .back-to-top { bottom: 80px; right: 20px; width: 45px; height: 45px; }
        }

        /* ==================== Report Modal & Toast ==================== */
        .report-modal { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); backdrop-filter: blur(5px); display: none; align-items: center; justify-content: center; z-index: 2000; padding: 20px; }
        .report-modal.show { display: flex; }
        .modal-box { background: white; width: 100%; max-width: 420px; border-radius: 20px; padding: 30px; box-shadow: var(--shadow-lg); animation: slideIn 0.3s ease; }
        @keyframes slideIn { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .report-option { display: flex; align-items: center; gap: 12px; padding: 14px 18px; border: 1px solid #e2e8f0; border-radius: 12px; margin-bottom: 12px; cursor: pointer; }
        .btn-send { flex: 2; background: var(--primary-color); color: white; border: none; padding: 14px; border-radius: 12px; font-family: 'Tajawal'; font-weight: 700; cursor: pointer; }
        .btn-cancel { flex: 1; background: #f1f5f9; color: #475569; border: none; padding: 14px; border-radius: 12px; font-family: 'Tajawal'; cursor: pointer; }
        .success-toast { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%) translateY(100px); background: #059669; color: white; padding: 14px 35px; border-radius: 50px; font-weight: 700; box-shadow: 0 10px 25px rgba(0,0,0,0.2); z-index: 3000; transition: 0.5s; opacity: 0; display: flex; align-items: center; gap: 12px; }
        .success-toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }
    </style>
</head>
<body>

<div class="nav-overlay" id="navOverlay" onclick="toggleMobileMenu()"></div>

<nav>
    <div class="logo-container"><a href="/index.html"><img src="/images/logo.png" alt="logo" /></a></div>
    <div class="nav-links" id="navLinks">
        <a href="/index.html">الرئيسية</a>
        <a href="/books.html">الكتب</a>
        <a href="/articles.html">المقالات</a>
        <a href="/hadith.html" class="active">الروايات</a>
        <a href="/khawatir.html">خواطر</a>
        <a href="/videos.html">الفيديوهات</a>
        <a href="/history.html">التاريخ</a>
        <a href="/podcast.html">البودكاست</a>
        <a href="/ask.html">الأسئلة</a>
        <a href="/hewar.html">حوارات</a>
        <a href="/inq.html">تساؤلات</a>
        <a href="/manhaj.html">المنهج</a>
        <a href="/favorites.html">المفضلة</a>
        <a href="/support.html">دعم المحتوى</a>
        <a href="/about.html">من نحن</a>
    </div>
    <div class="hamburger" onclick="toggleMobileMenu()"><i class="fas fa-bars"></i></div>
</nav>

<div class="font-controls-fixed">
    <button class="font-btn" id="fontIncrease" title="تكبير"><i class="fas fa-plus"></i></button>
    <button class="font-btn" id="fontReset" title="إعادة"><i class="fas fa-redo"></i></button>
    <button class="font-btn" id="fontDecrease" title="تصغير"><i class="fas fa-minus"></i></button>
</div>

<button class="back-to-top" id="backToTop" title="العودة للأعلى"><i class="fas fa-chevron-up"></i></button>

<header class="unified-header">
    <h1 class="page-title">روايات تناقض بعضها</h1>
    <p class="page-subtitle">فحص نقدي للمرويات التي تعارضت مع النص القرآني</p>
    <div class="universal-search">
        <input type="text" id="globalSearch" placeholder="ابحث في جميع المحتويات..." />
        <div class="search-results" id="searchResults"></div>
    </div>
</header>

<div class="container">
    <div id="hadithContainer"></div>

    <div id="pagination-wrapper">
        <div class="pagination-info-container">
            <span id="pageInfo">الصفحة 1 من 1</span>
            <span class="total-count-badge" id="totalHadithCount">عدد الروايات: 0</span>
        </div>
        <div style="margin-top: 15px;">
            <button id="firstPage" class="pagination-btn">الأولى</button>
            <button id="prevPage" class="pagination-btn">السابق</button>
            <button id="nextPage" class="pagination-btn">التالي</button>
        </div>
    </div>

    <!-- قسم تابعنا -->
    <div class="social-section">
        <h2 style="font-weight: 800; color: var(--primary-dark); margin-bottom: 10px;">تابعنا على منصات التواصل</h2>
        <div class="social-grid">
            <a href="https://youtube.com/@husseinalkhalil" target="_blank" class="social-btn social-yt" title="يوتيوب"><img src="/icons/yot-soc.png" alt="yt"></a>
            <a href="https://www.facebook.com/hussien.alkhalil" target="_blank" class="social-btn social-fb" title="فيسبوك"><img src="/icons/fac-soc.png" alt="fb"></a>
            <a href="https://instagram.com/husseinalkhalil" target="_blank" class="social-btn social-ins" title="إنستغرام"><img src="/icons/ins-soc.png" alt="in"></a>
            <a href="https://t.me/tanoeer" target="_blank" class="social-btn social-tg" title="تلغرام"><img src="/icons/tel-soc.png" alt="tg"></a>
            <a href="https://tiktok.com/@h.alkhalil" target="_blank" class="social-btn social-tk" title="تيك توك"><img src="/icons/tik-soc.png" alt="tk"></a>
            <a href="https://snapchat.com/t/sFLWjw3K" target="_blank" class="social-btn social-sc" title="سناب شات"><img src="/icons/snap.png" alt="sc"></a>
        </div>
    </div>
</div>

<div class="report-modal" id="reportModal">
    <div class="modal-box">
        <h2>إبلاغ عن محتوى</h2>
        <p id="modalHadithInfo">أنت تبلغ عن: جاري التحديد...</p>
        <form name="hadith-reports" id="reportForm" method="POST" data-netlify="true">
            <input type="hidden" name="hadith_name" id="hiddenHadithName">
            <input type="hidden" name="hadith_number" id="hiddenHadithNumber">
            <label class="report-option"><input type="radio" name="issue_type" value="الرابط لا يعمل" required> <span>الرابط لا يعمل</span></label>
            <label class="report-option"><input type="radio" name="issue_type" value="الحديث غير مطابق"> <span>الحديث غير مطابق</span></label>
            <label class="report-option"><input type="radio" name="issue_type" value="رقم الحديث غير مطابق"> <span>رقم الحديث غير مطابق</span></label>
            <div class="modal-footer" style="display:flex; gap:10px; margin-top:20px;">
                <button type="submit" class="btn-send">إرسال البلاغ</button>
                <button type="button" class="btn-cancel" onclick="closeReportModal()">إلغاء</button>
            </div>
        </form>
    </div>
</div>

<div class="success-toast" id="successToast"><i class="fas fa-check-circle"></i> <span>شكراً لمساهمتك</span></div>

<footer>
    <div class="footer-links">
        <a href="/terms.html">الشروط والأحكام</a> <span class="footer-divider">|</span>
        <a href="/privacy.html">سياسة الخصوصية</a> <span class="footer-divider">|</span>
        <a href="/contact.html">اتصل بنا</a> <span class="footer-divider">|</span>
        <a href="/feedback.html">شاركنا رأيك</a>
    </div>
    <div class="copyright">حسين الخليل - جميع الحقوق محفوظة © 2025</div>
</footer>

<script>
    // ==================== البيانات والبرمجة ====================
    const novelsData = [
        {
            id: 2, title: "رواية جئتكم بالذبح", source: "صحيح الموارد", sourceUrl: "https://dorar.net/h/qFBPLzjX",
            text: "عن عبد الله بن عمرو بن العاص قال: حضرنا قريشاً فقال النبي ﷺ: أتسمعون يا معشر قريش؟ أما والذي نفس محمد بيده لقد جئتكم بالذبح.", num: "6567",
            reason: "تُظهر هذه الرواية النبي في صورة 'المتوعّد بالقتل والذبح' منذ بدايات الدعوة في مكة، وهو ما يصدم العقل والمنطق؛ فالدعوة بدأت بالكلمة الطيبة والموعظة الحسنة. كلمة 'الذبح' كلمة وحشية لا تليق بمقام النبوة ولا برجل وُصف بأنه 'رحمة للعالمين'. هذه الرواية تُستخدم كذريعة للجماعات المتطرفة لتبرير أفعالها، بينما كان شعار النبي في القرآن هو الصبر والصفح الجميل حتى في أحلك ظروف الاضطهاد المكي.",
            proofs: [
                { label: "عالمية الرحمة:", verse: "وَمَا أَرْسَلْنَاكَ إِلَّا رَحْمَةً لِّلْعَالَمِينَ", ref: "الأنبياء: 107", comment: "والرحمة والذبح نقيضان لا يجتمان." },
                { label: "أدب الدعوة:", verse: "ادْعُ إِلَىٰ سَبِيلِ رَبِّكَ بِالْحِكْمَةِ وَالْمَوْعِظَةِ الْحَسَنَةِ", ref: "النحل: 125", comment: "التوعّد بالذبح ليس من الحكمة ولا الموعظة الحسنة." },
                { label: "مأمور بالصفح:", verse: "فَاصْفَحِ الصَّفْحَ الْجَمِيلَ", ref: "الحجر: 85", comment: "والذبح هو أقصى درجات الانتقام، بينما القرآن أمره بالجمال في الصفح." },
                { label: "الرد على الأذى:", verse: "وَلَا تَسْتَوِي الْحَسَنَةُ وَلَا السَّيِّئَةُ ۚ ادْفَع| بِالَّتِي هِيَ أَحْسَنُ", ref: "فصلت: 34", comment: "فكيه يدفع بالتي هي أحسن من يقول 'جئتكم بالذبح'؟" }
            ]
        },
        {
            id: 3, title: "رواية جعل رزقي تحت ظل رمحي", source: "إرواء الغليل", sourceUrl: "https://dorar.net/h/LvAcRXno",
            text: "عن ابن عمر قال: قال رسول الله ﷺ: بُعثت بالسيف بين يدي الساعة حتى يُعبد الله وحده لا شريك له، وجُعل رزقي تحت ظل رمحي، وجُعل الذل والصغار على من خالف أمري.", num: "5/109",
            sourceUrl: "https://dorar.net/h/LvAcRXno",
            text: "عن ابن عمر قال: قال رسول الله ﷺ: بُعثت بالسيف بين يدي الساعة حتى يُعبد الله وحده لا شريك له، وجُعل رزقي تحت ظل رمحي، وجُعل الذل والصغار على من خالف أمري.", num: "5/109",
            reason: "تُصور هذه الرواية الإسلام كدين 'ارتزاق من الحرب'، حيث تربط بين 'رزق النبي' وبين 'الرمح' (الغنائم والسلب)، وهذا يطعن في نزاهة النبوة ويجعلها غاية لتحصيل الأموال والقهر. كما تصف المخالفين بـ 'الذل والصغار' بينما القرآن الكريم يعترف بالاختلاف البشري ويأمر بالبر والقسط مع غير المسلمين المسالمين. فالمهمة النبوية هي 'الهداية' وليست 'الجباية' أو 'الإذلال'.",
            proofs: [
                { label: "الاستغناء عن أجر الناس:", verse: "وَمَا أَسْأَلُكُمْ عَلَيْهِ مِنْ أَجْرٍ ۖ إِنْ أَجْرِيَ إِلَّا عَلَىٰ رَبِّ الْعَالَمِينَ", ref: "الشعراء: 109", comment: "فكيه يكون رزقه تحت ظل رمحه وهو لا يطلب أجراً من الأصل؟" },
                { label: "وظيفة الرسول:", verse: "إِنَّمَا أَنْتَ مُنَذِرٌ / وَمَا أَرْسَلْنَاكَ إِلَّا مُبَشِّرًا وَنَذِيرًا", ref: "الرعد: 7 / الفرقان: 56", comment: "لم يقل القرآن 'أرسلناك محارباً لترتزق من السيوف'." },
                { label: "الكرامة الإنسانية:", verse: "وَلَقَدْ كَرَّمْنَا بَنِي آدَمَ", ref: "الإسراء: 70", comment: "الرواية تقول بجعل 'الذل والصغار' على من خالف، بينما القرآن يقرر الكرامة لكل بني آدم." },
                { label: "الرزق من الله:", verse: "نَحْنُ نَرْزُقُكَ ۗ وَالْعَاقِبَةُ لِلتَّقْوَىٰ", ref: "طه: 132", comment: "الرزق النبوي مكفول بضمان الله وتوفيقه، وليس مرهوناً بحد السيف والدم." }
            ]
        {
    ];

    let currentPage = 1;
    const perPage = 15;
    let currentFontSizeRem = 1.15;

    function normalizeArabic(text) {
        if (!text) return "";
        return text
            .replace(/[\u064B-\u065F]/g, "") 
            .replace(/[أإآ]/g, "ا")           
            .replace(/ة/g, "ه")               
            .replace(/ى/g, "ي")               
            .trim();
    }

    function highlightText(text, query) {
        if (!query) return text;
        
        const regex = new RegExp(`(${query.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
        return text.replace(regex, '<mark>$1</mark>');
    }

    function toggleMobileMenu() {
        const links = document.getElementById('navLinks');
        const overlay = document.getElementById('navOverlay');
        links.classList.toggle('show');
        overlay.style.display = links.classList.contains('show') ? 'block' : 'none';
        document.body.classList.toggle('no-scroll');
    }

    function performSearch() {
        const query = normalizeArabic(document.getElementById('globalSearch').value.toLowerCase());
        const resultsContainer = document.getElementById('searchResults');
        resultsContainer.innerHTML = '';
        resultsContainer.style.display = 'none';

        if (query === '') return;

        let results = [];
        novelsData.forEach((novel, index) => {
            const searchField = normalizeArabic(novel.title + novel.text + novel.reason).toLowerCase();
            if (searchField.includes(query)) {
                results.push({ ...novel, originalIndex: index });
            }
        });

        if (results.length === 0) {
            resultsContainer.innerHTML = '<div class="search-item" style="text-align:center; color:#888;">لا توجد نتائج</div>';
            resultsContainer.style.display = 'block';
            return;
        }

        results.slice(0, 10).forEach(result => {
            const item = document.createElement('div');
            item.className = 'search-item';
            
            // تمييز النص في النتائج
            const highlightedTitle = highlightText(result.title, query);
            const highlightedSource = highlightText(result.source, query);
            
            item.innerHTML = `<strong>${highlightedTitle}</strong><br><small>${highlightedSource}</small>`;
            item.onclick = () => {
                jumpToNovel(result.originalIndex, result.id, query);
                resultsContainer.style.display = 'none';
                document.getElementById('globalSearch').value = '';
            };
            resultsContainer.appendChild(item);
        });
        resultsContainer.style.display = 'block';
    }

    function jumpToNovel(index, id, searchQuery = null) {
        currentPage = Math.floor(index / perPage) + 1;
        renderNovels(searchQuery);
        setTimeout(() => {
            const card = document.getElementById(`card-h${id}`);
            if (card) {
                const details = card.querySelector('.hadith-details');
                if (!details.classList.contains('open')) {
                    toggleHadith(card.querySelector('.hadith-summary'));
                }
                card.scrollIntoView({ behavior: 'smooth', block: 'center' });
                card.style.boxShadow = "0 0 15px var(--primary-light)";
                setTimeout(() => card.style.boxShadow = "var(--shadow-sm)", 2000);
            }
        }, 300);
    }

    function renderNovels(searchQuery = null) {
        const container = document.getElementById('hadithContainer');
        container.innerHTML = "";
        const start = (currentPage - 1) * perPage;
        const end = start + perPage;
        const pageData = novelsData.slice(start, end);

        pageData.forEach((novel) => {
            // تمييز النص إذا كان هناك بحث
            let titleText = novel.title;
            let reasonText = novel.reason;
            let textText = novel.text;
            
            if (searchQuery) {
                titleText = highlightText(titleText, searchQuery);
                reasonText = highlightText(reasonText, searchQuery);
                textText = highlightText(textText, searchQuery);
            }

            let proofsHTML = "";
            novel.proofs.forEach(p => {
                let verseText = p.verse;
                let labelText = p.label;
                let commentText = p.comment;
                
                if (searchQuery) {
                    verseText = highlightText(verseText, searchQuery);
                    labelText = highlightText(labelText, searchQuery);
                    commentText = highlightText(commentText, searchQuery);
                }
                
                proofsHTML += `<div class="section-content"><b>${labelText}</b> قال تعالى: <span style="color: #0056b3;">{${verseText}}</span> <span style="color: #28a745; font-size: 0.8rem;">[${p.ref}]</span>. ${commentText}</div>`;
            });

            container.innerHTML += `
            <div class="hadith-row">
                <div class="hadith-number-circle">${novel.id}</div>
                <div class="hadith-card" id="card-h${novel.id}">
                    <i class="far fa-bookmark fav-header-icon" title="أضف للمفضلة" onclick="toggleFavorite(event, '${novel.id}')"></i>
                    <div class="hadith-summary" onclick="toggleHadith(this)">
                        <h3>${titleText}</h3>
                        <div style="display:flex; align-items:center; gap:12px;">
                            <span class="source-tag">${novel.source}</span>
                            <i class="fas fa-chevron-down toggle-icon"></i>
                        </div>
                    </div>
                    <div class="hadith-details">
                        <div class="detail-section">
                            <div class="section-header"><i class="fas fa-quote-right"></i> نص الرواية (1)</div>
                            <div class="section-content">${textText}</div>
                            ${novel.num ? `<div class="section-content"><b style="font-weight: bold;">رقم الرواية (1): ${novel.num}</b></div>` : ''}
                            <div class="hadith-actions">
                                <a href="${novel.sourceUrl}" target="_blank" class="action-btn btn-source"><i class="fas fa-external-link-alt"></i> مصدر الرواية (1)</a>
                                <div class="action-btn btn-report" onclick="openReportModal('${novel.title}', '${novel.num}')"><i class="fas fa-flag"></i> إبلاغ</div>
                            </div>
                        </div>
                        <div class="detail-section">
                            <div class="section-header"><i class="fas fa-quote-right"></i> نص الرواية (2)</div>
                            <div class="section-content">${textText}</div>
                            ${novel.num ? `<div class="section-content"><b style="font-weight: bold;">رقم الرواية (2): ${novel.num}</b></div>` : ''}
                            <div class="hadith-actions">
                                <a href="${novel.sourceUrl}" target="_blank" class="action-btn btn-source"><i class="fas fa-external-link-alt"></i> مصدر الرواية (2)</a>
                                <div class="action-btn btn-report" onclick="openReportModal('${novel.title}', '${novel.num}')"><i class="fas fa-flag"></i> إبلاغ</div>
                            </div>
                        </div>
                        <div class="detail-section">
                            <div class="section-header"><i class="fas fa-exclamation-triangle"></i> وجه التناقض</div>
                            <div class="section-content">${reasonText}</div>
                        </div>
                    </div>
                </div>
            </div>`;
        });
        updatePaginationUI();
        syncFavIcons();
    }

    function toggleHadith(el) {
        const details = el.nextElementSibling;
        const row = el.closest('.hadith-row');
        details.classList.toggle('open');
        row.classList.toggle('is-open');
        const icon = el.querySelector('.toggle-icon');
        if(icon) icon.style.transform = details.classList.contains('open') ? 'rotate(180deg)' : 'rotate(0deg)';
    }

    function toggleFavorite(e, id) {
        e.stopPropagation();
        const cardId = 'h' + id;
        let favs = JSON.parse(localStorage.getItem('myFavorites')) || [];
        const idx = favs.findIndex(f => f.id === cardId);

        if (idx > -1) {
            favs.splice(idx, 1);
        } else {
            const novel = novelsData.find(n => n.id == id);
            favs.push({ id: cardId, title: novel.title, type: 'رواية' });
        }

        localStorage.setItem('myFavorites', JSON.stringify(favs));
        syncFavIcons();
    }

    function syncFavIcons() {
        const favs = JSON.parse(localStorage.getItem('myFavorites')) || [];
        document.querySelectorAll('.fav-header-icon').forEach(icon => {
            const onclickAttr = icon.getAttribute('onclick');
            const idMatch = onclickAttr.match(/'(\d+)'/);
            if (idMatch) {
                const cardId = 'h' + idMatch[1];
                const isFav = favs.some(f => f.id === cardId);
                icon.classList.toggle('fas', isFav);
                icon.classList.toggle('far', !isFav);
                icon.style.color = isFav ? "var(--primary-color)" : "var(--matte-purple)";
            }
        });
    }

    function updateFontSize() {
        document.documentElement.style.setProperty('--dynamic-content-size', currentFontSizeRem + 'rem');
    }

    document.getElementById('fontIncrease').onclick = () => { currentFontSizeRem += 0.1; updateFontSize(); };
    document.getElementById('fontDecrease').onclick = () => { if(currentFontSizeRem > 0.8) currentFontSizeRem -= 0.1; updateFontSize(); };
    document.getElementById('fontReset').onclick = () => { currentFontSizeRem = 1.15; updateFontSize(); };

    function updatePaginationUI() {
        const totalPages = Math.ceil(novelsData.length / perPage);
        const totalHadiths = novelsData.length;
        
        document.getElementById('pageInfo').textContent = `الصفحة ${currentPage} من ${totalPages}`;
        document.getElementById('totalHadithCount').textContent = `عدد الروايات: ${totalHadiths}`;
        
        document.getElementById('prevPage').disabled = (currentPage === 1);
        document.getElementById('nextPage').disabled = (currentPage === totalPages);
        document.getElementById('firstPage').disabled = (currentPage === 1);
    }

    document.getElementById('nextPage').onclick = () => { currentPage++; renderNovels(); window.scrollTo(0, 400); };
    document.getElementById('prevPage').onclick = () => { currentPage--; renderNovels(); window.scrollTo(0, 400); };
    document.getElementById('firstPage').onclick = () => { currentPage = 1; renderNovels(); window.scrollTo(0, 400); };

    function openReportModal(title, num) {
        document.getElementById('hiddenHadithName').value = title;
        document.getElementById('hiddenHadithNumber').value = num;
        document.getElementById('modalHadithInfo').textContent = `أنت تبلغ عن: ${title} (رواية رقم ${num})`;
        document.getElementById('reportModal').classList.add('show');
        document.body.classList.add('no-scroll');
    }
    
    function closeReportModal() {
        document.getElementById('reportModal').classList.remove('show');
        document.body.classList.remove('no-scroll');
    }

    document.getElementById("reportForm").addEventListener("submit", function(e) {
        e.preventDefault();
        const formData = new FormData(this);
        fetch("/", {
            method: "POST",
            headers: { "Content-Type": "application/x-www-form-urlencoded" },
            body: new URLSearchParams(formData).toString(),
        }).then(() => {
            closeReportModal();
            const toast = document.getElementById("successToast");
            toast.classList.add("show");
            setTimeout(() => toast.classList.remove("show"), 3500);
            this.reset();
        });
    });

    window.addEventListener('scroll', () => {
        const btt = document.getElementById('backToTop');
        if (window.scrollY > 400) btt.classList.add('show');
        else btt.classList.remove('show');
    });

    document.getElementById('backToTop').onclick = () => window.scrollTo({ top: 0, behavior: 'smooth' });
    document.getElementById('globalSearch').addEventListener('input', performSearch);

    document.addEventListener('DOMContentLoaded', () => {
        renderNovels();
        updateFontSize();
    });
</script>
</body>
</html>
