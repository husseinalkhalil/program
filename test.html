<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>الخمر وحكمه - حسين الخليل</title>
    <!-- AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4459876088599546" crossorigin="anonymous"></script>
    <!-- Favicon -->
    <link href="images/logo-small.png" rel="icon" type="image/png"/>
    <link href="images/logo-small.png" rel="apple-touch-icon"/>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* ==================== Shared Styles (Unified Identity) ==================== */
        :root {
            --primary-color: #5e2ca5;
            --primary-dark: #451b7a;
            --primary-light: #8a5bc7;
            --accent-color: #ffd700;
            --bg-color: #f9f7f2;
            --surface-color: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.05);
            --shadow-md: 0 6px 12px rgba(0,0,0,0.08);
            --shadow-lg: 0 15px 25px rgba(0,0,0,0.1);
            
            --radius-lg: 1rem;
            --radius-xl: 1.5rem;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Tajawal', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-primary);
            line-height: 1.8;
            overflow-x: hidden;
        }

        a { text-decoration: none; color: inherit; transition: all 0.3s ease; }

        /* Navigation */
        .nav-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.5); backdrop-filter: blur(4px);
            z-index: 998; display: none;
        }

        nav {
            background: rgba(94, 44, 165, 0.95);
            backdrop-filter: blur(10px);
            padding: 0.8rem 2%;
            position: fixed; width: 100%; top: 0;
            z-index: 1000;
            display: flex; align-items: center; justify-content: space-between;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .logo-container img { height: 40px; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2)); }

        .nav-links {
            display: flex; flex: 1; justify-content: space-evenly; align-items: center;
            flex-wrap: wrap; margin: 0 20px;
        }

        .nav-links a {
            color: white; font-weight: 700; font-size: 1.05rem;
            padding: 8px 12px; border-radius: 20px;
            display: flex; align-items: center; gap: 5px; white-space: nowrap;
        }

        .nav-links a:hover { background: rgba(255,255,255,0.15); transform: translateY(-2px); }

        .hamburger { display: none; color: white; font-size: 1.5rem; cursor: pointer; }

        /* Hero Section */
        .hero-section {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
            padding: 120px 20px 100px;
            text-align: center; color: white;
            border-radius: 0 0 50px 50px;
            position: relative; z-index: 10;
        }

        .hero-content {
            max-width: 900px; margin: 0 auto;
            display: flex; flex-direction: column; align-items: center; gap: 20px;
        }

        .hero-text h1 { font-size: 2.2rem; margin-bottom: 10px; font-weight: 800; line-height: 1.4; }
        .hero-text p { font-size: 1.1rem; opacity: 0.9; max-width: 600px; margin: 0 auto; }

        /* Search Box */
        .universal-search { width: 100%; max-width: 600px; position: relative; margin-top: 20px; }
        #globalSearch {
            width: 100%; padding: 18px 50px 18px 25px;
            border-radius: 50px; border: none; font-size: 1rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            font-family: 'Tajawal', sans-serif; outline: none;
            background: white; transition: all 0.3s;
        }
        #globalSearch:focus { box-shadow: 0 10px 30px rgba(255, 255, 255, 0.25); transform: scale(1.02); }
        .search-icon-placeholder {
            position: absolute; right: 20px; top: 50%; transform: translateY(-50%);
            color: var(--primary-color); pointer-events: none;
        }

        /* Container & Main Layout */
        .container { max-width: 1400px; margin: 0 auto; padding: 0 20px; }
        
        .main-wrapper {
            position: relative; z-index: 20; margin-top: -50px;
            max-width: 1100px; 
            margin-left: auto; margin-right: auto;
            margin-bottom: 60px;
        }

        /* ==================== Article Specific Styles ==================== */
        .article-content-container {
            background: var(--surface-color);
            border-radius: var(--radius-xl);
            padding: 50px;
            box-shadow: var(--shadow-md);
            border: 1px solid rgba(0,0,0,0.03);
            position: relative;
        }

        .article-meta {
            display: flex; justify-content: center; gap: 15px;
            margin-bottom: 30px; padding-bottom: 20px;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            color: var(--text-secondary); font-size: 0.95rem;
        }
        
        .article-meta span { display: flex; align-items: center; gap: 5px; }
        .article-meta i { color: var(--primary-color); }

        .article-body {
            font-size: 1.2rem;
            color: var(--text-primary);
            text-align: justify; line-height: 1.9;
        }

        .article-body p { margin-bottom: 20px; }
        .article-body strong { color: var(--primary-dark); }

        .article-body h3 {
            color: var(--primary-color);
            margin: 30px 0 15px;
            position: relative; display: inline-block;
            font-size: 1.4rem; font-weight: 800;
        }
        .article-body h3::after {
            content: ''; display: block; width: 40px; height: 3px;
            background: var(--accent-color); margin-top: 5px;
        }

        /* Font Controls (Fixed Left) */
        .font-controls-fixed {
            position: fixed; top: 120px; left: 30px;
            display: flex; flex-direction: column; gap: 10px;
            z-index: 990;
        }
        
        .font-btn {
            width: 45px; height: 45px; border-radius: 50%;
            background: white; border: 1px solid #e2e8f0;
            color: var(--primary-color); cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.1rem; box-shadow: var(--shadow-sm);
            transition: all 0.3s;
        }
        .font-btn:hover { background: var(--primary-color); color: white; transform: scale(1.1); }

        /* Search Highlight */
        .highlight-text {
            background-color: var(--accent-color);
            color: #000;
            padding: 2px 0;
            border-radius: 2px;
            animation: highlightFade 2s forwards;
        }

        /* Action Buttons */
        .article-actions {
            margin-top: 50px; padding-top: 25px;
            border-top: 1px solid #eee;
            display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;
        }
        
        .action-btn-pill {
            padding: 10px 25px; border-radius: 30px;
            border: 1px solid #e2e8f0; background: transparent;
            color: var(--text-secondary); font-weight: 600;
            cursor: pointer; display: flex; align-items: center; gap: 8px;
            transition: all 0.3s;
        }
        .action-btn-pill:hover { background: var(--primary-color); color: white; border-color: var(--primary-color); }

        /* Separator */
        .text-separator {
            text-align: center; margin: 40px 0; color: var(--primary-color); font-size: 1.5rem;
        }

        /* Footer */
        footer { background: var(--primary-dark); color: white; padding: 40px 20px; text-align: center; margin-top: auto; }
        .footer-links { display: flex; justify-content: center; gap: 20px; margin-bottom: 20px; flex-wrap: wrap; }
        .footer-links a { color: rgba(255,255,255,0.8); font-size: 0.9rem; }
        .footer-links a:hover { color: var(--accent-color); }
        .copyright { color: rgba(255,255,255,0.6); font-size: 0.85rem; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 20px; }

        .back-to-top {
            position: fixed; bottom: 30px; right: 30px;
            width: 50px; height: 50px; background: var(--primary-color); color: white;
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            cursor: pointer; opacity: 0; pointer-events: none; transition: 0.3s;
            z-index: 995; box-shadow: var(--shadow-md); font-size: 1.2rem;
        }
        .back-to-top.visible { opacity: 1; pointer-events: all; }
        .back-to-top:hover { transform: translateY(-5px); background: var(--primary-dark); }

        /* Search Results Info */
        .search-results-alert {
            background: var(--accent-color); color: #000;
            padding: 10px 20px; border-radius: 30px;
            position: fixed; top: 80px; left: 50%; transform: translateX(-50%);
            z-index: 990; font-weight: bold; display: none;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        @media print {
            nav, .hero-section, .font-controls-fixed, .article-actions, footer, .back-to-top, .universal-search { display: none; }
            .main-wrapper { margin: 0; max-width: 100%; }
            .article-content-container { box-shadow: none; border: none; }
            body { background: white; color: black; }
        }

        @media (max-width: 1200px) {
            .hamburger { display: block; order: 1; }
            .logo-container { order: 2; }
            .nav-links {
                position: fixed; top: 60px; right: -280px; width: 280px;
                background: var(--surface-color); flex-direction: column;
                padding: 20px; height: calc(100vh - 60px);
                box-shadow: -5px 0 15px rgba(0,0,0,0.1); transition: right 0.3s ease;
                overflow-y: auto; flex-wrap: nowrap; justify-content: flex-start;
                gap: 10px; margin: 0; flex: unset;
            }
            .nav-links.show { right: 0; }
            .nav-links a { color: var(--text-primary); width: 100%; padding: 12px; border-radius: 8px; font-size: 1rem; justify-content: flex-start; }
            .nav-links a:hover { background: rgba(0,0,0,0.05); color: var(--primary-color); transform: none; }
            nav { padding: 0.8rem 5%; }
            
            .font-controls-fixed {
                top: auto; bottom: 30px; left: 30px; 
                flex-direction: row; 
            }
        }

        @media (max-width: 768px) {
            .hero-text h1 { font-size: 1.8rem; }
            .article-content-container { padding: 25px; }
            .footer-links { gap: 12px; }
            .main-wrapper { max-width: 100%; }
        }
    </style>
</head>
<body>

    <div class="nav-overlay" onclick="toggleMobileMenu()"></div>

    <!-- Navigation -->
    <nav>
        <div class="logo-container">
            <a href="index.html">
                <img src="images/logo.png" alt="شعار حسين الخليل" />
            </a>
        </div>

        <div class="nav-links">
            <a href="index.html">الرئيسية</a>
            <a href="books.html">الكتب</a>
            <a href="articles.html" style="background: rgba(255,255,255,0.2);">المقالات</a>
            <a href="khawatir.html">خواطر</a>
            <a href="videos.html">الفيديوهات</a>
            <a href="history.html">التاريخ</a>
            <a href="podcast.html">البودكاست</a>
            <a href="ask.html">الأسئلة</a>
            <a href="hewar.html">حوارات</a>
            <a href="inq.html">تساؤلات</a>
            <a href="manhaj.html">المنهج</a>
            <a href="favorites.html">المفضلة</a>
            <a href="support.html">دعم المحتوى</a>
            <a href="about.html">من نحن</a>
            <a href="#" onclick="window.print()" title="طباعة"><i class="fas fa-print"></i></a>
        </div>

        <div class="hamburger" onclick="toggleMobileMenu()">
            <i class="fas fa-bars"></i>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="hero-section">
        <div class="hero-content">
            <div class="hero-text">
                <h1>❖ الخمر وحكمه</h1>
                <p>هل الاجتناب يعني التحريم؟ قراءة في النصوص والمفاهيم</p>
            </div>
            
            <!-- Universal Search inside Hero -->
            <div class="universal-search">
                <i class="fas fa-search search-icon-placeholder"></i>
                <input type="text" id="globalSearch" placeholder="ابحث عن كلمة داخل المقال..." />
            </div>
        </div>
    </header>

    <div class="search-results-alert" id="searchAlert">
        تم العثور على <span id="matchCount">0</span> نتيجة
    </div>

    <!-- Font Controls (Fixed on Left/Bottom) -->
    <div class="font-controls-fixed">
        <button class="font-btn" id="fontIncrease" title="تكبير الخط"><i class="fas fa-plus"></i></button>
        <button class="font-btn" id="fontReset" title="إعادة تعيين"><i class="fas fa-redo"></i></button>
        <button class="font-btn" id="fontDecrease" title="تصغير الخط"><i class="fas fa-minus"></i></button>
    </div>

    <!-- Main Content Wrapper -->
    <div class="container main-wrapper">
        <div class="article-content-container">
            <div class="article-meta">
                <span><i class="far fa-calendar-alt"></i> 27 مايو 2025</span>
                <span><i class="far fa-folder"></i> مقالات فكرية</span>
            </div>

            <!-- Content Body (محتوى المقال: الخمر وحكمه) -->
            <div class="article-body" id="articleBody">
                <p>هل الخمر <strong><span style="color: #ef4444;">محرم؟</span></strong></p>
                <p>هل الاجتناب يعني التحريم؟</p>
                <p>هل يصل إلى درجة التحريم بما أنه إثم؟</p>
                
                <h3>مفهوم الاجتناب:</h3>
                
                <p>عند دخولك إلى مدينة كبرى، تجد لافتة مكتوب عليها عبارتين:</p>
                <p><strong><span style="color: var(--primary-color);">الأولى:</span></strong> لو أكملت مسارك بشكل مستقيم ستدخل إلى وسط المدينة.</p>
                <p><strong><span style="color: var(--primary-color);">الثانية:</span></strong> لو انعطفت يمينًا، ستجد طريقًا جانبيًا يجنبك الدخول إلى وسط المدينة.</p>
                
                <p>لك حرية الاختيار، إذا سلكت الطريق الجانبي، ستتجنب الكثير من المشاكل بدخولك إلى وسط المدينة، كتجنب إشارات المرور والازدحام والشرطة والمطبات ووو...الخ.</p>
                <p>لكن هذا لا يعني أن الدخول إلى وسط المدينة خطر أو ممنوع قانونيًّا، ولكن إذا قررت الدخول إلى وسط المدينة فعليك تحمل المسؤولية.</p>
                
                <p><span style="color: var(--primary-color); font-weight: bold;">أما من الناحية الشرعية:</span></p>
                <p>الاجتناب درجة مختلفة عن التحريم، وتكون في أمر مذموم وفي أحيان يبلغ درجة المنكر <strong>"مثل قول الزور"</strong> وهي لا تعني أيضاً أن الخمر أمر محمود بالمطلق.</p>
                
                <p>أخبرنا الله سبحانه وتعالى في القرآن: <span style="color: var(--primary-color); font-weight: bold;">﴿إِن تَجْتَنِبُوا كَبَائِرَ مَا تُنْهَوْنَ عَنْهُ نُكَفِّرْ عَنكُمْ سَيِّئَاتِكُمْ وَنُدْخِلْكُم مُّدْخَلًا كَرِيمًا﴾</span> النساء [31].</p>
                
                <p><strong><span style="color: var(--primary-color);">فهل الخمر من كبائر ما نُهينا عنه؟</span></strong></p>
                <p>لا أعتقد ذلك وفق الآيات، فلا يمكن أن نضع الخمر بجانب أكل أموال الناس بالباطل، لكن إدمان الخمر وسوء استخدامه قد يؤدي بصاحب النفس المائلة، إلى الفجور، وقد يرتكب من المظالم ما هو أشنع من قول الزور عند شربه للخمر.</p>
                
                <p><strong><span style="color: var(--primary-color);">هل الخمر أمر سيء؟</span></strong></p>
                <p>في الغالب، <strong>نعم،</strong> إذا نظرنا إلى المجتمعات المتعارف فيها شرب الخمر، نجد البعض يتحول إلى بهيمة هائجة عند شربه له، والبعض يصبح إنسانًا شاعريًا، والآخر يسرد كل تاريخه الفاضح، مع أنه في صباح نفس اليوم، كان يحاضر فريق عمله في الأخلاق وضبط النفس.</p>
                <p>في تلك المجتمعات، نُصادف قلة من الناس لا يتبعون أي مذهب أو تعاليم في كتاب يمنعهم من الخمر، لكنهم يختارون اجتنابها طلبًا لسلامة البدن والعقل.</p>
                
                <p>لذلك مسألة الخمر أراها تعتمد على الشخص نفسه وقابليته لاستغلالها بالدرجة الأولى، لا أقول أنها حلال بل هي أقرب للحرام ولكن لا يمكن أن أضعها في سلة واحدة مع الشرك بالله وقتل النفس التي حرم الله وأكل أموال اليتامى ظلماً والسرقة وعبادة الطاغوت.</p>
                
                <p>شارب الخمر أعتقد أنه مُسائل أمام الله بجريرة ما يرتكب من أمور عند شربه، فلو سكر واعتدى بالضرب أو قتل أو سرق، فلا أعتقد أن سكرته تعذره بأي شكل من الأشكال عن أخذ جزاء ما ارتكب أمام الله، لذا فالأمر خطير جداً.</p>
                <p>في المقابل إن شرب ولم يسكر، وكان واعي فيما يقول، فلا مشكلة لديه إطلاقاً في أن يقيم الصلاة.</p>
                
                <p>هنا الضابط <span style="color: var(--primary-color); font-weight: bold;">﴿يَا أَيُّهَا الَّذِينَ آمَنُوا لَا تَقْرَبُوا الصَّلَاةَ وَأَنتُمْ سُكَارَىٰ حَتَّىٰ تَعْلَمُوا مَا تَقُولُونَ﴾</span> النساء [43].</p>
                
                <p><strong><span style="color: var(--primary-color);">لكن ما معنى سُكارى وما علاقتها بالخمر؟</span></strong></p>
                <p>سكارى تعني حالة من اللا وعي وعدم إدراك ما يفعل أو ما يقول، وقد يكون ذلك أيضاً بسبب التعب الجسدي بسبب إرهاق العمل.</p>
                <p>فالشخص الذي في حالة سُكر، هو شخص مشوش الأفكار وغير مُدرك لما يفعل ويقول.</p>
                <p>لهذا، أمر الله الإنسان بعدم الصلاة في هذه الحالة حتى يذهب عنه سُكْرُه ويصبح خالي الذهن ومن ثم يصلي.</p>
                
                <p>يقول تعالى: <span style="color: var(--primary-color); font-weight: bold;">﴿وَتَرَى ٱلنَّاسَ سُكَٰرَىٰ وَمَا هُم بِسُكَٰرَىٰ وَلَٰكِنَّ عَذَابَ ٱللَّهِ شَدِيدٌ﴾</span> الحج [2].</p>
                <p>يعطي لنا الله في هذه الآية توضيحاً لكلمة سُكارى وهو عدم الإدراك واللا وعي من هول الموقف عند قيام الساعة. فالسُكْر لا يقتصر على الخمر فقط، فكل ما يُذهِب العقل هو مُسكِر.</p>
                
                <p>أما اعتبار الخمر محرّم لأنه من الفواحش، وأن الله حرّم الفواحش <span style="color: var(--primary-color); font-weight: bold;">﴿قُلْ إِنَّمَا حَرَّمَ رَبِّىَ ٱلْفَوَٰحِشَ مَا ظَهَرَ مِنْهَا وَمَا بَطَنَ﴾</span> الأعراف [33].</p>
                
                <p>فعلينا أولاً أن نراجع الآيات التي ذكر الله فيها <strong>"إثم"</strong> ونقابلها بالآيات التي جاءت فيها مُعرّفة (الإثم).</p>
                
                <p><strong><span style="color: var(--primary-color);">سأعطي مثالاً:</span></strong></p>
                <p><strong>1-</strong> <span style="color: var(--primary-color); font-weight: bold;">﴿لَوْلَا يَنْهَاهُمُ الرَّبَّانِيُّونَ وَالْأَحْبَارُ عَن قَوْلِهِمُ الْإِثْمَ وَأَكْلِهِمُ السُّحْتَ ۚ لَبِئْسَ مَا كَانُوا يَصْنَعُونَ﴾</span> المائدة [63].</p>
                <p>فهنا الإثم "قول" لا علاقة له بالخمر.</p>
                
                <p><strong>2-</strong> <span style="color: var(--primary-color); font-weight: bold;">﴿يَا أَيُّهَا الَّذِينَ آمَنُوا اجْتَنِبُوا كَثِيرًا مِّنَ الظَّنِّ إِنَّ بَعْضَ الظَّنِّ إِثْمٌ ۖ وَلَا تَجَسَّسُوا وَلَا يَغْتَب بَّعْضُكُم بَعْضًا﴾</span> الحجرات [12].</p>
                <p>في هذه الآية ورد لفظ <strong>"إثم"</strong> غير مُعرّف.</p>
                
                <p><strong><span style="color: var(--primary-color);">فهل يصح أن نقول أن بعض الظن محرم؟</span></strong></p>
                <p>لا أعتقد.</p>
                <p>الأصح أن نقول هو إثم كما قالت الآية، أي معناه أنه شيء مُضر للفرد والمجتمع.</p>
                <p>وكذلك الخمر فيها من الضرر ما فيها (إثم كبير).</p>
                
                <p><strong><span style="color: var(--primary-color);">هل هو من كبائر الإثم؟</span></strong></p>
                <p>قد يكون ذلك في حالة الإدمان وإهلاك النفس.</p>
                <p>فالخمر هو كل ما يخامر عقل الإنسان أو يغلق منافذ الإدراك عنه.</p>
                <p>الله يشفي كل مُبتلى بإدمان هذا المنكر ويعوضه فيما يغنيه عن إضرار هذا الابتلاء.</p>
                
                <div class="text-separator">✦ ✦ ✦</div>
            </div>

            <!-- Actions -->
            <div class="article-actions">
                <button class="action-btn-pill" onclick="window.print()">
                    <i class="fas fa-print"></i> طباعة المقال
                </button>
                <button class="action-btn-pill" onclick="handleShare()">
                    <i class="fas fa-share-alt"></i> مشاركة المقال
                </button>
                <button class="action-btn-pill" onclick="copyLink()">
                    <i class="fas fa-link"></i> نسخ الرابط
                </button>
            </div>
        </div>
    </div>

    <!-- Back to Top -->
    <div class="back-to-top" onclick="scrollToTop()">
        <i class="fas fa-arrow-up"></i>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-links">
                <a href="terms.html">الشروط والأحكام</a>
                <a href="privacy.html">سياسة الخصوصية</a>
                <a href="contact.html">اتصل بنا</a>
                <a href="feedback.html">شاركنا رأيك</a>
            </div>
            <div class="copyright">
                حسين الخليل - جميع الحقوق محفوظة © 2025
            </div>
        </div>
    </footer>

    <script>
        // Toggle Mobile Menu
        function toggleMobileMenu() {
            const navLinks = document.querySelector('.nav-links');
            const overlay = document.querySelector('.nav-overlay');
            navLinks.classList.toggle('show');
            overlay.style.display = navLinks.classList.contains('show') ? 'block' : 'none';
        }

        // Font Resizing Logic
        const articleBody = document.getElementById('articleBody');
        const defaultFontSize = 1.2; // rem
        let currentFontSize = defaultFontSize;

        document.getElementById('fontIncrease').addEventListener('click', () => {
            if (currentFontSize < 2.5) {
                currentFontSize += 0.1;
                articleBody.style.fontSize = `${currentFontSize}rem`;
            }
        });

        document.getElementById('fontDecrease').addEventListener('click', () => {
            if (currentFontSize > 0.9) {
                currentFontSize -= 0.1;
                articleBody.style.fontSize = `${currentFontSize}rem`;
            }
        });

        document.getElementById('fontReset').addEventListener('click', () => {
            currentFontSize = defaultFontSize;
            articleBody.style.fontSize = `${defaultFontSize}rem`;
        });

        // Search and Highlight Logic
        const searchInput = document.getElementById('globalSearch');
        const originalContent = articleBody.innerHTML; // Keep a clean copy

        searchInput.addEventListener('input', function() {
            const searchTerm = this.value.trim();
            const alertBox = document.getElementById('searchAlert');
            const matchCountSpan = document.getElementById('matchCount');

            // Reset if empty
            if (searchTerm === '') {
                articleBody.innerHTML = originalContent;
                alertBox.style.display = 'none';
                return;
            }

            // Create regex for search (case insensitive, global)
            const regex = new RegExp(`(${searchTerm})`, 'gi');
            
            // Temporary container to parse HTML
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = originalContent;

            // Helper function to traverse text nodes
            let matchCount = 0;
            function highlightNodes(node) {
                if (node.nodeType === 3) { // Text node
                    const text = node.nodeValue;
                    if (regex.test(text)) {
                        const newHtml = text.replace(regex, `<span class="highlight-text">$1</span>`);
                        const span = document.createElement('span');
                        span.innerHTML = newHtml;
                        node.parentNode.replaceChild(span, node);
                        
                        // Count occurrences (approximate)
                        const matches = text.match(regex);
                        if(matches) matchCount += matches.length;
                    }
                } else if (node.nodeType === 1 && node.childNodes && !/(script|style)/i.test(node.tagName)) {
                    // Element node, recurse
                    for (let i = 0; i < node.childNodes.length; i++) {
                        highlightNodes(node.childNodes[i]);
                    }
                }
            }

            highlightNodes(tempDiv);

            if (matchCount > 0) {
                articleBody.innerHTML = tempDiv.innerHTML;
                matchCountSpan.textContent = matchCount;
                alertBox.style.display = 'block';
                
                // Scroll to first match
                const firstMatch = document.querySelector('.highlight-text');
                if(firstMatch) {
                    firstMatch.scrollIntoView({behavior: 'smooth', block: 'center'});
                }
            } else {
                articleBody.innerHTML = originalContent;
                matchCountSpan.textContent = "0";
                alertBox.style.display = 'block';
            }
        });

        // Share & Copy Link
        function handleShare() {
            if (navigator.share) {
                navigator.share({
                    title: document.title,
                    url: window.location.href
                }).catch(console.error);
            } else {
                copyLink();
            }
        }

        function copyLink() {
            navigator.clipboard.writeText(window.location.href).then(() => {
                alert("تم نسخ رابط المقال بنجاح ✅");
            });
        }

        // Back to Top
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        window.addEventListener('scroll', () => {
            const btn = document.querySelector('.back-to-top');
            if (window.scrollY > 300) btn.classList.add('visible');
            else btn.classList.remove('visible');
        });
    </script>
</body>
</html>
