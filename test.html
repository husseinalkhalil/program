<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>المنهج - حسين الخليل</title>
    <!-- AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4459876088599546" crossorigin="anonymous"></script>
    <!-- Favicon -->
    <link href="images/logo-small.png" rel="icon" type="image/png"/>
    <link href="images/logo-small.png" rel="apple-touch-icon"/>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* Shared Variables & Styles */
        :root {
            --primary-color: #5e2ca5;
            --primary-dark: #451b7a;
            --primary-light: #8a5bc7;
            --accent-color: #ffd700;
            --bg-color: #f9f7f2;
            
            /* اللون الجديد الموحد: ضباب اللافندر */
            --surface-color: #F8F5FD; 
            
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            
            /* تحديث الظلال */
            --shadow-sm: 0 4px 15px rgba(94, 44, 165, 0.08);
            --shadow-md: 0 8px 20px rgba(94, 44, 165, 0.12);
            --shadow-lg: 0 15px 30px rgba(0,0,0,0.1);
            
            --radius-lg: 1rem;
            --radius-xl: 1.5rem;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* منع السكرول عند فتح القائمة */
        body.no-scroll {
            overflow: hidden !important;
            height: 100vh;
        }

        a { text-decoration: none; color: inherit; transition: all 0.3s ease; }

        /* ==================== Navigation ==================== */
        .nav-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.6); backdrop-filter: blur(4px);
            z-index: 998; display: none;
        }

        nav {
            background: rgba(94, 44, 165, 0.95);
            backdrop-filter: blur(10px);
            padding: 0.8rem 2%;
            position: fixed; width: 100%; top: 0;
            z-index: 1000;
            display: flex; align-items: center; justify-content: space-between;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .logo-container img { height: 40px; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2)); }

        .nav-links {
            display: flex; flex: 1; justify-content: space-evenly;
            align-items: center; flex-wrap: wrap; margin: 0 20px;
        }

        .nav-links a {
            color: white; font-weight: 700; font-size: 1.05rem;
            padding: 8px 12px; border-radius: 20px;
            display: flex; align-items: center; gap: 5px; white-space: nowrap;
        }

        .nav-links a:hover { background: rgba(255,255,255,0.15); transform: translateY(-2px); }

        .hamburger { display: none; color: white; font-size: 1.5rem; cursor: pointer; }

        @media (max-width: 1200px) {
            .hamburger { display: block; order: 1; }
            .logo-container { order: 2; }
            .nav-links {
                position: fixed; top: 60px; right: -280px; width: 280px;
                background: var(--surface-color); /* استخدام اللون الجديد */
                flex-direction: column;
                padding: 20px; height: calc(100vh - 60px);
                box-shadow: -5px 0 15px rgba(0,0,0,0.1); transition: right 0.3s ease;
                overflow-y: auto; flex-wrap: nowrap; justify-content: flex-start;
                gap: 10px; margin: 0; flex: unset;
            }
            .nav-links.show { right: 0; }
            .nav-links a { 
                color: var(--text-primary); width: 100%; padding: 12px; 
                border-radius: 8px; font-size: 1rem; justify-content: flex-start; 
                border-bottom: 1px solid rgba(0,0,0,0.03);
            }
            .nav-links a:hover { background: rgba(94, 44, 165, 0.05); color: var(--primary-color); transform: none; }
            nav { padding: 0.8rem 5%; }
        }

        /* Hero Section */
        .hero-section {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
            padding: 120px 20px 140px; /* مسافة سفلية إضافية للتداخل */
            text-align: center; color: white;
            border-radius: 0 0 50px 50px; position: relative;
            z-index: 1; /* الخلفية في الطبقة السفلية */
        }

        .hero-content {
            max-width: 900px; margin: 0 auto;
            display: flex; flex-direction: column; align-items: center; gap: 20px;
        }

        .hero-text h1 { font-size: 2.5rem; margin-bottom: 10px; font-weight: 800; }
        .hero-text p { font-size: 1.2rem; opacity: 0.9; max-width: 700px; margin: 0 auto; }

        /* Global Search Box (Inside Main Wrapper) */
        .universal-search { 
            width: 100%; max-width: 600px; 
            position: relative; 
            z-index: 100; /* أعلى طبقة */
            margin: 0 auto 40px auto; 
        }
        
        #globalSearch {
            width: 100%; padding: 18px 50px 18px 25px;
            border-radius: 50px; border: none; font-size: 1rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            font-family: 'Tajawal', sans-serif; outline: none; background: white;
            transition: box-shadow 0.3s ease;
        }
        #globalSearch:focus { box-shadow: 0 0 0 4px rgba(255, 215, 0, 0.4); }

        .search-icon-placeholder {
            position: absolute; right: 20px; top: 50%; transform: translateY(-50%);
            color: var(--primary-color); pointer-events: none;
        }
        
        /* Search Results Dropdown */
        .search-results {
            position: absolute; top: 115%; left: 0; right: 0;
            background: #ffffff; border-radius: 15px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.2); max-height: 400px;
            overflow-y: auto; z-index: 200; text-align: right;
            display: none; color: var(--text-primary);
            border: 1px solid rgba(0,0,0,0.05);
        }
        .search-results::-webkit-scrollbar { width: 8px; }
        .search-results::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 0 0 0 15px; }
        .search-results::-webkit-scrollbar-thumb { background: var(--primary-light); border-radius: 4px; }

        .search-count {
            padding: 10px 20px; font-size: 0.9rem; color: var(--primary-color);
            border-bottom: 2px solid rgba(94, 44, 165, 0.1); background: #f8fafc;
            border-radius: 15px 15px 0 0; font-weight: 700;
        }

        .search-item {
            padding: 15px 20px; border-bottom: 1px solid rgba(0,0,0,0.05);
            cursor: pointer; transition: background 0.2s;
        }
        .search-item:last-child { border-bottom: none; }
        .search-item:hover { background: rgba(94, 44, 165, 0.05); }
        .search-item h3 { color: var(--primary-color); font-size: 1rem; margin-bottom: 5px; font-weight: 700; }
        .search-item p { font-size: 0.9rem; color: var(--text-secondary); margin: 0; line-height: 1.4; }
        .search-item mark { background-color: #ffd700; color: #422006; padding: 0 3px; border-radius: 3px; }

        /* Container Structure */
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        .main-wrapper {
            position: relative;
            z-index: 20; /* طبقة البطاقات */
            margin-top: -90px; /* سحب للأعلى */
            max-width: 1000px;
            margin-left: auto; margin-right: auto; margin-bottom: 60px;
        }

        /* Manhaj Specific Styles */
        .intro-card, .conclusion-card {
            background: var(--surface-color); border-radius: var(--radius-xl);
            padding: 40px; box-shadow: var(--shadow-sm); text-align: center;
            margin-bottom: 50px; font-size: 1.1rem; line-height: 1.8;
            color: var(--text-primary); border: 1px solid rgba(0,0,0,0.03);
        }

        .principles-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px; margin-bottom: 50px;
        }

        .principle-card {
            background: var(--surface-color); border-radius: 16px; padding: 25px;
            box-shadow: var(--shadow-sm); border: 1px solid rgba(0,0,0,0.03);
            border-right: 5px solid var(--primary-color); transition: all 0.3s;
            display: flex; flex-direction: column;
        }
        .principle-card:hover { transform: translateY(-5px); box-shadow: var(--shadow-lg); }
        .principle-card h3 { color: var(--primary-dark); margin-bottom: 15px; font-size: 1.2rem; font-weight: 800; }
        .principle-card p { color: var(--text-secondary); font-size: 1rem; line-height: 1.6; margin: 0; }

        /* Accordion */
        .accordion-wrapper { display: flex; flex-direction: column; gap: 15px; margin-bottom: 50px; }
        details {
            background: var(--surface-color); border-radius: 16px;
            box-shadow: var(--shadow-sm); overflow: hidden; transition: all 0.3s ease;
            border: 1px solid rgba(0,0,0,0.03);
            position: relative; z-index: 1;
        }
        details:hover { box-shadow: var(--shadow-md); }
        details[open] { border-color: rgba(94, 44, 165, 0.2); }
        summary {
            padding: 20px 25px; font-weight: 700; font-size: 1.1rem;
            color: var(--primary-dark); cursor: pointer; list-style: none;
            position: relative; display: flex; align-items: center; justify-content: space-between;
            transition: background 0.3s;
        }
        summary::-webkit-details-marker { display: none; }
        summary::after {
            content: '\f078'; font-family: "Font Awesome 6 Free"; font-weight: 900;
            color: var(--primary-color); transition: transform 0.3s;
        }
        details[open] summary::after { transform: rotate(180deg); }
        details[open] summary { background: rgba(94, 44, 165, 0.05); border-bottom: 1px solid rgba(0,0,0,0.05); }
        details p { padding: 25px; margin: 0; color: var(--text-secondary); line-height: 1.8; font-size: 1rem; background: white; }

        /* Social */
        .social-section { text-align: center; margin-bottom: 60px; background: var(--surface-color); padding: 40px; border-radius: var(--radius-xl); box-shadow: var(--shadow-sm); }
        .section-title { text-align: center; margin-bottom: 40px; position: relative; }
        .section-title h2 { color: var(--primary-color); font-size: 2rem; display: inline-block; padding-bottom: 15px; }
        .section-title h2::after { content: ''; position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 60px; height: 4px; background: var(--accent-color); border-radius: 2px; }
        .social-grid { display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; margin-top: 30px; }
        .social-btn { width: 50px; height: 50px; border-radius: 50%; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.05); transition: all 0.3s; }
        .social-btn img { width: 24px; height: 24px; transition: 0.3s; }
        .social-btn:hover { transform: translateY(-5px) scale(1.1); }
        .social-btn:hover img { filter: brightness(0) invert(1); }
        .social-btn.facebook:hover { background: #1877F2; }
        .social-btn.instagram:hover { background: #E4405F; }
        .social-btn.youtube:hover { background: #FF0000; }
        .social-btn.tiktok:hover { background: #000000; }
        .social-btn.telegram:hover { background: #0088CC; }
        .social-btn.snap:hover { background: #FFFC00; }
        .social-btn.snap:hover img { filter: none; }

        /* Footer */
        footer { background: var(--primary-dark); color: white; padding: 40px 20px; text-align: center; margin-top: auto; }
        .footer-links { display: flex; justify-content: center; gap: 20px; margin-bottom: 20px; flex-wrap: wrap; }
        .footer-links a { color: rgba(255,255,255,0.8); font-size: 0.9rem; }
        .footer-links a:hover { color: var(--accent-color); }
        .copyright { color: rgba(255,255,255,0.6); font-size: 0.85rem; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 20px; }

        /* Fixed Buttons */
        .share-fixed-btn { position: fixed; bottom: 30px; left: 30px; width: 50px; height: 50px; background: var(--accent-color); border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 15px rgba(0,0,0,0.2); cursor: pointer; z-index: 990; transition: 0.3s; }
        .share-fixed-btn:hover { transform: scale(1.1); }
        .share-fixed-btn img { width: 24px; filter: brightness(0); }
        .back-to-top { position: fixed; bottom: 30px; right: 30px; width: 50px; height: 50px; background: var(--primary-color); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; opacity: 0; pointer-events: none; transition: 0.3s; z-index: 995; box-shadow: var(--shadow-md); font-size: 1.2rem; }
        .back-to-top.visible { opacity: 1; pointer-events: all; }
        .back-to-top:hover { transform: translateY(-5px); background: var(--primary-dark); }
        .copy-alert { position: fixed; top: 100px; left: 50%; transform: translateX(-50%); background: var(--primary-color); color: white; padding: 12px 25px; border-radius: 30px; box-shadow: var(--shadow-lg); z-index: 10000; opacity: 0; transition: 0.3s; pointer-events: none; }
        .copy-alert.show { opacity: 1; }

        @media (max-width: 900px) {
            .hero-text h1 { font-size: 2rem; }
            .hero-section { padding: 100px 20px 160px; } /* مسافة إضافية للموبايل */
            .share-fixed-btn { display: none; }
            .principles-grid { grid-template-columns: 1fr; }
        }

        @media (max-width: 768px) {
            .footer-links { gap: 12px; flex-wrap: wrap; justify-content: center; }
            .footer-links a { font-size: 0.9rem; white-space: nowrap; }
            .social-grid { gap: 5px; flex-wrap: nowrap; justify-content: center; }
            .social-btn { width: 48px; height: 48px; flex-shrink: 0; }
            .social-btn img { width: 24px; height: 24px; }
        }
    </style>
</head>
<body>

    <div class="nav-overlay" onclick="toggleMobileMenu()"></div>

    <!-- Navigation -->
    <nav>
        <div class="logo-container">
            <a href="index.html">
                <img src="images/logo.png" alt="شعار حسين الخليل" />
            </a>
        </div>

        <div class="nav-links">
            <a href="index.html">الرئيسية</a>
            <a href="books.html">الكتب</a>
            <a href="articles.html">المقالات</a>
            <a href="khawatir.html">خواطر</a>
            <a href="videos.html">الفيديوهات</a>
            <a href="history.html">التاريخ</a>
            <a href="podcast.html">البودكاست</a>
            <a href="ask.html">الأسئلة</a>
            <a href="hewar.html">حوارات</a>
            <a href="inq.html">تساؤلات</a>
            <a href="manhaj.html" style="background: rgba(255,255,255,0.2);">المنهج</a>
            <a href="favorites.html">المفضلة</a>
            <a href="support.html">دعم المحتوى</a>
            <a href="about.html">من نحن</a>
            <a href="#" onclick="window.print()" title="طباعة"><i class="fas fa-print"></i></a>
            <a href="#" onclick="handleMobileShare(); return false;" class="mobile-share-link" style="display: none;">مشاركة</a>
        </div>

        <div class="hamburger" onclick="toggleMobileMenu()">
            <i class="fas fa-bars"></i>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="hero-section">
        <div class="hero-content">
            <div class="hero-text">
                <h1>منهج فهم القرآن</h1>
                <p>إطار منهجي مباشر وواضح لقراءة القرآن من داخله</p>
            </div>
        </div>
    </header>

    <!-- Main Content Wrapper -->
    <div class="container main-wrapper">
        
        <!-- Global Search Box (Inside Main Wrapper) -->
        <div class="universal-search">
            <i class="fas fa-search search-icon-placeholder"></i>
            <input type="text" id="globalSearch" placeholder="ابحث في جميع المحتويات..." />
            <div class="search-results" id="searchResults"></div>
        </div>

        <div id="manhajContent">
            <!-- Introduction -->
            <div class="intro-card searchable-item">
                <h2 style="color:var(--primary-color); margin-bottom:15px;">مقدمة</h2>
                <p>الهدف من هذا المنهج هو تقديم إطار واضح يسمح بقراءة القرآن من داخله، بعيدًا عن سلطة الروايات والتقليد، ومن دون تبعية لمذهب أو مرجعية بشرية. المرجعية الأولى والأخيرة هي النص القرآني؛ وما عداه يُعامل كمادة تاريخية أو لغوية لا كسُلطة فوق النص ولا في موازاته أو جنبًا إلى جنب معه.</p>
            </div>

            <!-- Principles -->
            <div class="section-title"><h2>أساسيات المنهج</h2></div>
            <div class="principles-grid">
                <div class="principle-card searchable-item">
                    <h3>1) مركزية النص القرآني</h3>
                    <p>الفهم يبدأ من الآية نفسها ومن مجموع النص، لا من الشروح اللاحقة. لا تُقدّم الروايات أو التفاسير على القرآن، وأي فهم يصطدم بظاهر النص أو بمبادئه الكبرى يُعاد تقييمه.</p>
                </div>
                <div class="principle-card searchable-item">
                    <h3>2) وحدة المفهوم القرآني</h3>
                    <p>لا نستخلص المعنى من آية وحيدة، بل من مجموع استعمال الكلمة في القرآن: جذرها، اشتقاقاتها، سياقاتها ومواضع ورودها والمجال الدلالي الذي تتشكل منه.</p>
                </div>
                <div class="principle-card searchable-item">
                    <h3>3) السياق البنيوي لا السياق الخارجي</h3>
                    <p>القرآن يفسّر بعضه بعضًا داخل بنيته النصية: ترتيب الأفكار، العلاقات الحجاجية، والانتقال الدلالي داخل السورة. ما يرد من روايات يُعامل كمرجع تاريخي وليس كأداة تفسيرية ملزمة.</p>
                </div>
                <div class="principle-card searchable-item">
                    <h3>4) الدقة اللغوية غير التراثية</h3>
                    <p>نعتمد المعنى العربي الأصلي للكلمات قبل أن تتحملها المدارس الاصطلاحية اللاحقة. نفرّق بين المعنى اللغوي والأثر المذهبي.</p>
                </div>
                <div class="principle-card searchable-item">
                    <h3>5) القراءة الأخلاقية للنص</h3>
                    <p>الالتزام بمبادئ كبرى متكررة في القرآن: العدل، الرحمة، عدم الظلم، والمسؤولية الفردية. أي فهم ينتج عنه ظلم أو تبرير للإكراه يُعد فهمًا ناقصًا.</p>
                </div>
                <div class="principle-card searchable-item">
                    <h3>6) نزع القداسة عن البشر</h3>
                    <p>لا عصمة إلّا للوحي نفسه. الفقهاء جزء من التاريخ الفكري، يمكن الأخذ منهم أو الرد عليهم، لكن لا تُسلم لهم السلطة على النص، وكل ما يقولون، إنما هو اجتهادهم قابل للأخذ والرد ولا يمكن أن يمنح صفة القداسة ولا الحقيقة المطلقة.</p>
                </div>
                <div class="principle-card searchable-item">
                    <h3>7) بناء الاستنتاج على منطق محكم</h3>
                    <p>الاستنتاج يقوم على دليل لغوي، اتساق نصي، والالتزام بالمبادئ الأخلاقية. إذا اختل عنصر، يجب مراجعة الاستنتاج.</p>
                </div>
                <div class="principle-card searchable-item">
                    <h3>8) ترتيل القرآن</h3>
                    <p>الترتيل هنا ليس القراءة الصوتية، بل جمعُ الآيات التي تتناول الموضوع الواحد وترتيبُها في بنية متكاملة لفهم مراد النص. فلا تُفهم المسألة القرآنية من آية منفردة، بل من خلال ضمّ جميع الآيات المتعلقة بها وترتيبها وتنظيمها وفق سياقها ودلالاتها وجذرها اللغوي.</p>
                </div>
                <div class="principle-card searchable-item">
                    <h3>9) قاعدة الارتكاز</h3>
                    <p>القرآن هو المصدر الوحيد للتشريع الديني، ولا يُقدَّم عليه أي نص أو رواية أو تراث. هو القاعدة والميزان والمعيار الذي تُقاس به المفاهيم؛ فما وافقه قُبل، وما خالفه رُدّ.</p>
                </div>
                <div class="principle-card searchable-item">
                    <h3>10) القراءة العقلانية</h3>
                    <p>عند تدبر القرآن، ينبغي الدخول إلى النص من دون حمولات مسبقة أو مفاهيم ورثتها عبر المذاهب والفتاوى. لا تبحث عمّا لقّنوك إياه داخل القرآن؛ بل اقرأه كأنك تقرأه للمرة الأولى، بعقل مفتوح وقلب خالٍ من التوجّهات المسبقة.</p>
                </div>
                <div class="principle-card searchable-item">
                    <h3>11) الإسقاطات</h3>
                    <p>عند التعامل مع أي مفهوم موروث، اجعل القرآن هو المرجعية التي تُسقط عليها الفكرة، لا العكس. فإن وُجد لها أصل قرآني فهي مقبولة، وإن لم يوجد فهي إضافة بشرية لا حجّية لها.</p>
                </div>
                <div class="principle-card searchable-item">
                    <h3>12) لا تُحمّل القرآن ما لا يقوله</h3>
                    <p>عند تحليل أي قضية دينية، لا يجوز أن نأتي بمفاهيم أو أحكام من خارج القرآن ثم نبحث لها عن أصل داخله أو نحاول إسقاط القرآن عليها. المنهج الصحيح هو أن يبدأ الباحث من داخل القرآن لا من خارجه.</p>
                </div>
            </div>

            <!-- Examples -->
            <div class="section-title"><h2>أمثلة تطبيقية مختصرة</h2></div>
            <div class="accordion-wrapper">
                <details class="searchable-item">
                    <summary>الذكر</summary>
                    <p>يوضع جذر <code>ذ-ك-ر</code> موضع الدراسة، ويتم تتبع مواضع ورود الكلمة لفهم حقلها الدلالي: التذكير، البيان، التبليغ والوعي—لا مجرد نص محفوظ.</p>
                </details>
                <details class="searchable-item">
                    <summary>الشيطان</summary>
                    <p>يُنظر إليه في سياق القرآن كمفهوم يشمل النزعات والإغواء والسلوك الذي يصدّ عن الهدى، وليس كمجرد شخصية متجسدة بالضرورة.</p>
                </details>
                <details class="searchable-item">
                    <summary>الدين</summary>
                    <p>يُفهم كمنظومة قيم وسلوك لا كمؤسسة كهنوتية أو مجرد طقوس، وفق ما يظهر من استعمال الكلمة النصي، علينا أن نعي جيدًا أن الإيمان مسألة فردية.</p>
                </details>
            </div>

            <!-- FAQs -->
            <div class="section-title"><h2>اعتراضات وأسئلة شائعة</h2></div>
            <div class="accordion-wrapper">
                <details class="searchable-item">
                    <summary>هل يلغي هذا التراث؟</summary>
                    <p>لا؛ التراث يبقى مادة بشرية تُستخدم أو تُقوّم، لكن لا تُمنح سلطة فوق النص القرآني.</p>
                </details>
                <details class="searchable-item">
                    <summary>من يضمن صحة الفهم؟</summary>
                    <p>لا يوجد ضامن بشري. الضمان منهجي: وضوح خطوات التحليل يجعل النتيجة قابلة للنقد والمراجعة.</p>
                </details>
                <details class="searchable-item">
                    <summary>لماذا لا نعتمد الروايات؟</summary>
                    <p>لأن النص (القرآن) لم يطلب مرجعًا فوقه، ولأن الروايات تأتي بعد النص بزمن وتختلف في دقتها ودلالتها.</p>
                </details>
                <details class="searchable-item">
                    <summary>هل المنهج مغلق؟</summary>
                    <p>المنهج قابلاً للمراجعة، لكنه يستند إلى أسس ثابتة: النص، اللغة، الأخلاق، والمنطق.</p>
                </details>
                <details class="searchable-item">
                    <summary>هل نحن ملزمون بكتب الروايات واجماع الفقهاء؟</summary>
                    <p>لا، نحن ملزمون بالوحي الوحيد فقط، (القرآن)، وكل ما هو دون القرآن من كتب روايات وفقه واجماع واتفاق، إنما هي اجتهادات بشرية لا قداسة لها.</p>
                </details>
            </div>

            <!-- Conclusion -->
            <div class="conclusion-card searchable-item">
                <h2 style="color:var(--primary-color); margin-bottom:15px;">خاتمة</h2>
                <p>المنهج هنا أداة لتحرير القراءة من القيود غير النصية؛ ليس مذهبًا جديدًا، بل إطارًا عمليًا لقراءةٍ منضبطة وقابلة للنقد. الهدف: الوصول إلى فهم أقرب للنص عبر خطوات واضحة ومفتوحة للمراجعة.</p>
            </div>
        </div>

        <!-- Social Media -->
        <div class="social-section" style="margin-top: 60px;">
            <div class="section-title">
                <h2>تابعني على مواقع التواصل</h2>
            </div>
            <div class="social-grid">
                <a href="https://youtube.com/@husseinalkhalil" target="_blank" class="social-btn youtube" title="يوتيوب">
                    <img src="icons/yot-soc.png" alt="يوتيوب">
                </a>
                <a href="https://www.facebook.com/share/1C2wBZkwXH/?mibextid=wwXIfr" target="_blank" class="social-btn facebook" title="فيسبوك">
                    <img src="icons/fac-soc.png" alt="فيسبوك">
                </a>
                <a href="https://www.instagram.com/husseinalkhalil?igsh=YmNhZWdlOWQ5NGNm&utm_source=qr" target="_blank" class="social-btn instagram" title="إنستغرام">
                    <img src="icons/ins-soc.png" alt="إنستغرام">
                </a>
                <a href="https://t.me/tanoeer" target="_blank" class="social-btn telegram" title="تلغرام">
                    <img src="icons/tel-soc.png" alt="تلغرام">
                </a>
                <a href="https://www.tiktok.com/@h.alkhalil?_t=ZS-8vj5cEPU6jp&_r=1" target="_blank" class="social-btn tiktok" title="تيك توك">
                    <img src="icons/tik-soc.png" alt="تيك توك">
                </a>
                <a href="https://snapchat.com/t/sFLWjw3K" target="_blank" class="social-btn snap" title="سناب شات">
                    <img src="icons/snap.png" alt="سناب شات">
                </a>
            </div>
        </div>
    </div>

    <!-- Fixed Buttons -->
    <div class="share-fixed-btn" onclick="handleMobileShare()">
        <img src="images/share.png" alt="مشاركة">
    </div>

    <div class="back-to-top" onclick="scrollToTop()">
        <i class="fas fa-arrow-up"></i>
    </div>

    <div class="copy-alert" id="copyAlert">تم نسخ الرابط بنجاح ✅</div>

    <footer>
        <div class="container">
            <div class="footer-links">
                <a href="terms.html">الشروط والأحكام</a>
                <a href="privacy.html">سياسة الخصوصية</a>
                <a href="contact.html">اتصل بنا</a>
                <a href="feedback.html">شاركنا رأيك</a>
            </div>
            <div class="copyright">
                حسين الخليل - جميع الحقوق محفوظة © 2025
            </div>
        </div>
    </footer>

    <script>
        // Toggle Mobile Menu
        function toggleMobileMenu() {
            const navLinks = document.querySelector('.nav-links');
            const overlay = document.querySelector('.nav-overlay');
            const body = document.body;

            navLinks.classList.toggle('show');
            
            if(navLinks.classList.contains('show')) {
                overlay.style.display = 'block';
                body.classList.add('no-scroll');
            } else {
                overlay.style.display = 'none';
                body.classList.remove('no-scroll');
            }
        }

        // Share
        function handleMobileShare() {
            const link = "https://www.husseinalkhalil.com/manhaj.html";
            if (navigator.share) {
                navigator.share({ title: 'منهج فهم القرآن - حسين الخليل', url: link }).catch(console.error);
            } else {
                navigator.clipboard.writeText(link).then(() => {
                    const alert = document.getElementById('copyAlert');
                    alert.classList.add('show');
                    setTimeout(() => alert.classList.remove('show'), 2000);
                });
            }
        }

        window.addEventListener('load', () => {
            if (window.innerWidth < 1200) {
                const mobileShareLink = document.querySelector('.mobile-share-link');
                if(mobileShareLink) mobileShareLink.style.display = 'flex';
            }
        });

        // Back to Top
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        window.addEventListener('scroll', () => {
            const btn = document.querySelector('.back-to-top');
            if (window.scrollY > 300) btn.classList.add('visible');
            else btn.classList.remove('visible');
        });

        // ==================== Global Search Logic ====================
        let cachedPagesContent = null;
        let isSearchInitialized = false;
        
        async function loadAllPagesContent() {
            if (cachedPagesContent) return cachedPagesContent;

            try {
                // Fetch site-map.json with cache busting
                const response = await fetch('site-map.json?v=' + new Date().getTime());
                if (!response.ok) throw new Error('Could not load site-map.json');
                const pagesList = await response.json();

                // Process each item
                const promises = pagesList.map(async (item) => {
                    let url = typeof item === 'string' ? item : item.url;
                    
                    let manualContent = (typeof item === 'object' && item.content) ? item.content : null;
                    let manualTitle = (typeof item === 'object' && item.page) ? item.page : null;

                    if (manualContent) {
                        return { 
                            page: manualTitle || url, 
                            url: url, 
                            content: manualContent 
                        };
                    }

                    try {
                        const pageResp = await fetch(url);
                        if (!pageResp.ok) return null;
                        const html = await pageResp.text();
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(html, 'text/html');
                        
                        doc.querySelectorAll('script, style, nav, footer, .no-search').forEach(el => el.remove());
                        const mainContent = doc.querySelector('.container, main, body') || doc.body;

                        return {
                            page: doc.title.replace('حسين الخليل - ', '').replace('الموقع الرسمي', '').trim() || 'صفحة',
                            url: url,
                            content: mainContent.textContent.replace(/\s+/g, ' ').trim()
                        };
                    } catch (e) { return null; }
                });

                const results = await Promise.all(promises);
                cachedPagesContent = results.filter(Boolean);
                return cachedPagesContent;
            } catch (error) {
                console.error("Search Error:", error);
                return [];
            }
        }

        function normalizeArabic(text) {
            if (!text) return '';
            text = text.replace(/[\u064B-\u065F\u0670]/g, ''); 
            text = text.replace(/[أإآ]/g, 'ا');
            text = text.replace(/[ة]/g, 'ه');
            text = text.replace(/[ى]/g, 'ي');
            text = text.replace(/[ؤ]/g, 'و');
            text = text.replace(/[ئ]/g, 'ي');
            return text;
        }

        function getSafeRegex(searchTerm) {
            let regexStr = '';
            const cleanTerm = normalizeArabic(searchTerm);
            
            for (let i = 0; i < cleanTerm.length; i++) {
                const char = cleanTerm[i];
                if (char === 'ا') regexStr += '[اأإآ]';
                else if (char === 'ه') regexStr += '[هة]';
                else if (char === 'ي') regexStr += '[يىئ]';
                else if (char === 'و') regexStr += '[وؤ]';
                else if (char.match(/[a-zA-Z]/)) regexStr += char;
                else regexStr += char.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                
                regexStr += '[\\u064B-\\u065F\\u0670]*'; 
            }
            return new RegExp(regexStr, 'gi');
        }

        function displayGlobalResults(results, queryRegex, container) {
            container.innerHTML = '';
            if (results.length === 0) {
                container.innerHTML = '<div class="search-item"><p>⚠️ لم يتم العثور على نتائج</p></div>';
                container.style.display = 'block';
                return;
            }
            
            // Add Count
            const countDiv = document.createElement('div');
            countDiv.className = 'search-count';
            countDiv.textContent = `تم العثور على ${results.length} نتيجة`;
            container.appendChild(countDiv);
            
            results.forEach(item => {
                const div = document.createElement('div');
                div.className = 'search-item';
                
                const highlightedTitle = item.page.replace(queryRegex, match => `<mark>${match}</mark>`);
                
                let snippet = '';
                queryRegex.lastIndex = 0;
                const match = queryRegex.exec(item.content);
                
                if (match) {
                    const start = Math.max(0, match.index - 60);
                    const end = Math.min(item.content.length, match.index + 100);
                    snippet = item.content.substring(start, end);
                    if (start > 0) snippet = '...' + snippet;
                    if (end < item.content.length) snippet = snippet + '...';
                } else {
                    snippet = item.content.substring(0, 150) + '...';
                }
                
                const highlightedSnippet = snippet.replace(queryRegex, match => `<mark>${match}</mark>`);

                // Pass query as parameter
                const searchTerm = document.getElementById('globalSearch').value.trim();
                div.innerHTML = `<h3>${highlightedTitle}</h3><p>${highlightedSnippet}</p>`;
                div.onclick = () => window.location.href = item.url + "?highlight=" + encodeURIComponent(searchTerm);
                container.appendChild(div);
            });
            container.style.display = 'block';
        }

        async function performGlobalSearch(query) {
            const resultsContainer = document.getElementById('searchResults');

            if (!query || query.length < 2) {
                resultsContainer.style.display = 'none';
                return;
            }
            
            // Dropdown results
            resultsContainer.innerHTML = '<div class="search-item"><p>جاري البحث في جميع المحتويات...</p></div>';
            resultsContainer.style.display = 'block';

            const data = await loadAllPagesContent();
            const searchRegex = getSafeRegex(query);
            
            const results = data.filter(item => {
                searchRegex.lastIndex = 0;
                const titleMatch = searchRegex.test(item.page);
                searchRegex.lastIndex = 0;
                const contentMatch = searchRegex.test(item.content);
                return titleMatch || contentMatch;
            });

            displayGlobalResults(results, searchRegex, resultsContainer);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // Setup Search Listener
            const searchInput = document.getElementById('globalSearch');
            let timer;
            if(searchInput) {
                searchInput.addEventListener('input', (e) => {
                    clearTimeout(timer);
                    timer = setTimeout(() => performGlobalSearch(e.target.value.trim()), 500);
                });
                searchInput.addEventListener('focus', () => {
                    if(!isSearchInitialized) { loadAllPagesContent(); isSearchInitialized = true; }
                });
            }

            // Close search on outside click
            document.addEventListener('click', (e) => {
                const searchContainer = document.querySelector('.universal-search');
                if(searchContainer && !searchContainer.contains(e.target)) {
                    document.getElementById('searchResults').style.display = 'none';
                }
            });
        });
    </script>
</body>
</html>
